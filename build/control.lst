ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"control.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.PID_value,"ax",%progbits
  18              		.align	1
  19              		.global	PID_value
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	PID_value:
  26              	.LFB159:
  27              		.file 1 "Src/control.c"
   1:Src/control.c **** #include "control.h"
   2:Src/control.c **** #include <stdint.h>
   3:Src/control.c **** #include "global.h"
   4:Src/control.c **** #include "tim.h"
   5:Src/control.c **** #include "arm_math.h"
   6:Src/control.c **** #include "main.h"
   7:Src/control.c **** #include "stm32f4xx_hal.h"
   8:Src/control.c **** 
   9:Src/control.c **** 
  10:Src/control.c **** 
  11:Src/control.c **** 
  12:Src/control.c **** /****************************************************************************************
  13:Src/control.c ****  * outline  : PID control
  14:Src/control.c ****  * argument : 
  15:Src/control.c ****  * return   : control value
  16:Src/control.c **** ********************************************************************************************/
  17:Src/control.c **** float PID_value(float target,float measured,float *sum,float*old,float Kp,float Ki,float Kd){
  28              		.loc 1 17 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33              	.LVL0:
  18:Src/control.c ****     float error;
  19:Src/control.c ****     float p,i,d;
  20:Src/control.c **** 
  21:Src/control.c ****     error = target - measured;
  34              		.loc 1 21 0
  35 0000 30EE600A 		vsub.f32	s0, s0, s1
  36              	.LVL1:
  22:Src/control.c ****     p = Kp*error;
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 2


  37              		.loc 1 22 0
  38 0004 20EE011A 		vmul.f32	s2, s0, s2
  39              	.LVL2:
  23:Src/control.c **** 
  24:Src/control.c ****     *sum += error * dt;
  40              		.loc 1 24 0
  41 0008 DFED0D7A 		vldr.32	s15, .L2
  42 000c 20EE270A 		vmul.f32	s0, s0, s15
  43              	.LVL3:
  44 0010 D0ED007A 		vldr.32	s15, [r0]
  45 0014 30EE270A 		vadd.f32	s0, s0, s15
  46 0018 80ED000A 		vstr.32	s0, [r0]
  25:Src/control.c ****     i = Ki * *sum;
  47              		.loc 1 25 0
  48 001c 20EE210A 		vmul.f32	s0, s0, s3
  49              	.LVL4:
  26:Src/control.c **** 
  27:Src/control.c ****     *old = measured;
  50              		.loc 1 27 0
  51 0020 C1ED000A 		vstr.32	s1, [r1]
  28:Src/control.c ****     d = Kd * (measured - *old);
  52              		.loc 1 28 0
  53 0024 70EEE00A 		vsub.f32	s1, s1, s1
  54              	.LVL5:
  55 0028 60EE820A 		vmul.f32	s1, s1, s4
  56              	.LVL6:
  29:Src/control.c **** 
  30:Src/control.c ****     return (p+i+d)/batt_Vcc;
  57              		.loc 1 30 0
  58 002c 31EE000A 		vadd.f32	s0, s2, s0
  59              	.LVL7:
  60 0030 70EE200A 		vadd.f32	s1, s0, s1
  61              	.LVL8:
  62 0034 034B     		ldr	r3, .L2+4
  63 0036 93ED000A 		vldr.32	s0, [r3]
  31:Src/control.c **** }
  64              		.loc 1 31 0
  65 003a 80EE800A 		vdiv.f32	s0, s1, s0
  66 003e 7047     		bx	lr
  67              	.L3:
  68              		.align	2
  69              	.L2:
  70 0040 6F12833A 		.word	981668463
  71 0044 00000000 		.word	batt_Vcc
  72              		.cfi_endproc
  73              	.LFE159:
  75              		.section	.text.Calc_Palam,"ax",%progbits
  76              		.align	1
  77              		.global	Calc_Palam
  78              		.syntax unified
  79              		.thumb
  80              		.thumb_func
  81              		.fpu fpv4-sp-d16
  83              	Calc_Palam:
  84              	.LFB160:
  32:Src/control.c **** 
  33:Src/control.c **** /****************************************************************************************
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 3


  34:Src/control.c ****  * outline  : calculate parameter
  35:Src/control.c ****  * argument : accel,*velocity,*distance
  36:Src/control.c ****  * return   : void
  37:Src/control.c **** ********************************************************************************************/
  38:Src/control.c **** void Calc_Palam(int16_t accel,int16_t *velocity,uint16_t *calc_tim){
  85              		.loc 1 38 0
  86              		.cfi_startproc
  87              		@ args = 0, pretend = 0, frame = 0
  88              		@ frame_needed = 0, uses_anonymous_args = 0
  89              		@ link register save eliminated.
  90              	.LVL9:
  39:Src/control.c ****     *calc_tim += 1;
  91              		.loc 1 39 0
  92 0000 1388     		ldrh	r3, [r2]
  93 0002 0133     		adds	r3, r3, #1
  94 0004 1380     		strh	r3, [r2]	@ movhi
  40:Src/control.c ****     *velocity += accel * dt;
  95              		.loc 1 40 0
  96 0006 07EE900A 		vmov	s15, r0	@ int
  97 000a F8EEE77A 		vcvt.f32.s32	s15, s15
  98 000e 9FED097A 		vldr.32	s14, .L5
  99 0012 27EE877A 		vmul.f32	s14, s15, s14
 100 0016 B1F90030 		ldrsh	r3, [r1]
 101 001a 07EE903A 		vmov	s15, r3	@ int
 102 001e F8EEE77A 		vcvt.f32.s32	s15, s15
 103 0022 77EE877A 		vadd.f32	s15, s15, s14
 104 0026 FDEEE77A 		vcvt.s32.f32	s15, s15
 105 002a 17EE903A 		vmov	r3, s15	@ int
 106 002e 0B80     		strh	r3, [r1]	@ movhi
  41:Src/control.c **** }
 107              		.loc 1 41 0
 108 0030 7047     		bx	lr
 109              	.L6:
 110 0032 00BF     		.align	2
 111              	.L5:
 112 0034 6F12833A 		.word	981668463
 113              		.cfi_endproc
 114              	.LFE160:
 116              		.global	__aeabi_f2d
 117              		.section	.text.Straight_Calc_fb,"ax",%progbits
 118              		.align	1
 119              		.global	Straight_Calc_fb
 120              		.syntax unified
 121              		.thumb
 122              		.thumb_func
 123              		.fpu fpv4-sp-d16
 125              	Straight_Calc_fb:
 126              	.LFB161:
  42:Src/control.c **** 
  43:Src/control.c **** 
  44:Src/control.c **** /****************************************************************************************
  45:Src/control.c ****  * outline  : calcurate accele distance
  46:Src/control.c ****  * argument : distance[mm],v_start[mm/s],v_end[mm/s]
  47:Src/control.c ****  * return   : void
  48:Src/control.c **** ********************************************************************************************/
  49:Src/control.c **** void Straight_Calc_fb(int16_t distant,int16_t v_start,int16_t v_end){
 127              		.loc 1 49 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 4


 128              		.cfi_startproc
 129              		@ args = 0, pretend = 0, frame = 0
 130              		@ frame_needed = 0, uses_anonymous_args = 0
 131              	.LVL10:
 132 0000 30B5     		push	{r4, r5, lr}
 133              	.LCFI0:
 134              		.cfi_def_cfa_offset 12
 135              		.cfi_offset 4, -12
 136              		.cfi_offset 5, -8
 137              		.cfi_offset 14, -4
 138 0002 2DED048B 		vpush.64	{d8, d9}
 139              	.LCFI1:
 140              		.cfi_def_cfa_offset 28
 141              		.cfi_offset 80, -28
 142              		.cfi_offset 81, -24
 143              		.cfi_offset 82, -20
 144              		.cfi_offset 83, -16
 145 0006 85B0     		sub	sp, sp, #20
 146              	.LCFI2:
 147              		.cfi_def_cfa_offset 48
  50:Src/control.c ****     float t1,t2,t3;
  51:Src/control.c ****     float constant_L;
  52:Src/control.c ****     calc.velocity = v_start;
 148              		.loc 1 52 0
 149 0008 324B     		ldr	r3, .L9
 150 000a 9980     		strh	r1, [r3, #4]	@ movhi
  53:Src/control.c ****     t1 = (float)(MAX_VELOCITY - v_start) / ACCEL;
 151              		.loc 1 53 0
 152 000c C1F59673 		rsb	r3, r1, #300
 153 0010 07EE903A 		vmov	s15, r3	@ int
 154 0014 F8EEE77A 		vcvt.f32.s32	s15, s15
 155 0018 9FED2F7A 		vldr.32	s14, .L9+4
 156 001c C7EE878A 		vdiv.f32	s17, s15, s14
 157              	.LVL11:
  54:Src/control.c ****     t3 = (float)(MAX_VELOCITY - v_end) / ACCEL;
 158              		.loc 1 54 0
 159 0020 C2F59672 		rsb	r2, r2, #300
 160              	.LVL12:
 161 0024 07EE902A 		vmov	s15, r2	@ int
 162 0028 F8EEE77A 		vcvt.f32.s32	s15, s15
 163 002c 87EE878A 		vdiv.f32	s16, s15, s14
 164              	.LVL13:
  55:Src/control.c **** 
  56:Src/control.c ****     constant_L = (float)distant - (MAX_VELOCITY + v_start) * t1 / 2 - (MAX_VELOCITY + v_start) * t3
 165              		.loc 1 56 0
 166 0030 07EE900A 		vmov	s15, r0	@ int
 167 0034 B8EEE77A 		vcvt.f32.s32	s14, s15
 168 0038 01F59671 		add	r1, r1, #300
 169              	.LVL14:
 170 003c 07EE901A 		vmov	s15, r1	@ int
 171 0040 F8EEE77A 		vcvt.f32.s32	s15, s15
 172 0044 67EEA86A 		vmul.f32	s13, s15, s17
 173 0048 B6EE006A 		vmov.f32	s12, #5.0e-1
 174 004c 66EE866A 		vmul.f32	s13, s13, s12
 175 0050 37EE667A 		vsub.f32	s14, s14, s13
 176 0054 67EE887A 		vmul.f32	s15, s15, s16
 177 0058 67EE867A 		vmul.f32	s15, s15, s12
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 5


 178 005c 77EE677A 		vsub.f32	s15, s14, s15
 179              	.LVL15:
  57:Src/control.c **** 
  58:Src/control.c ****     t2 = constant_L / MAX_VELOCITY;
 180              		.loc 1 58 0
 181 0060 9FED1E7A 		vldr.32	s14, .L9+8
 182 0064 87EE879A 		vdiv.f32	s18, s15, s14
 183              	.LVL16:
  59:Src/control.c ****     printf("\nt1:%f,t2:%f,t3%f\r\n",t1,t2,t3);
 184              		.loc 1 59 0
 185 0068 18EE900A 		vmov	r0, s17
 186              	.LVL17:
 187 006c FFF7FEFF 		bl	__aeabi_f2d
 188              	.LVL18:
 189 0070 0446     		mov	r4, r0
 190 0072 0D46     		mov	r5, r1
 191 0074 18EE100A 		vmov	r0, s16
 192 0078 FFF7FEFF 		bl	__aeabi_f2d
 193              	.LVL19:
 194 007c CDE90201 		strd	r0, [sp, #8]
 195 0080 19EE100A 		vmov	r0, s18
 196 0084 FFF7FEFF 		bl	__aeabi_f2d
 197              	.LVL20:
 198 0088 CDE90001 		strd	r0, [sp]
 199 008c 2246     		mov	r2, r4
 200 008e 2B46     		mov	r3, r5
 201 0090 1348     		ldr	r0, .L9+12
 202 0092 FFF7FEFF 		bl	printf
 203              	.LVL21:
  60:Src/control.c **** 
  61:Src/control.c ****     t1 *= 1000;
 204              		.loc 1 61 0
 205 0096 DFED137A 		vldr.32	s15, .L9+16
 206 009a 68EEA78A 		vmul.f32	s17, s17, s15
 207              	.LVL22:
  62:Src/control.c ****     t2 *= 1000;
 208              		.loc 1 62 0
 209 009e 29EE279A 		vmul.f32	s18, s18, s15
 210              	.LVL23:
  63:Src/control.c ****     t3 *= 1000;
 211              		.loc 1 63 0
 212 00a2 28EE278A 		vmul.f32	s16, s16, s15
 213              	.LVL24:
  64:Src/control.c **** 
  65:Src/control.c ****     accel_T = t1;
 214              		.loc 1 65 0
 215 00a6 FCEEE88A 		vcvt.u32.f32	s17, s17
 216              	.LVL25:
 217 00aa 0F4B     		ldr	r3, .L9+20
 218 00ac 18EE902A 		vmov	r2, s17	@ int
 219 00b0 1A80     		strh	r2, [r3]	@ movhi
  66:Src/control.c ****     constant_T = t2;
 220              		.loc 1 66 0
 221 00b2 BCEEC99A 		vcvt.u32.f32	s18, s18
 222              	.LVL26:
 223 00b6 0D4B     		ldr	r3, .L9+24
 224 00b8 19EE102A 		vmov	r2, s18	@ int
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 6


 225 00bc 1A80     		strh	r2, [r3]	@ movhi
  67:Src/control.c ****     decrease_T = t3;
 226              		.loc 1 67 0
 227 00be BCEEC88A 		vcvt.u32.f32	s16, s16
 228              	.LVL27:
 229 00c2 0B4B     		ldr	r3, .L9+28
 230 00c4 18EE102A 		vmov	r2, s16	@ int
 231 00c8 1A80     		strh	r2, [r3]	@ movhi
  68:Src/control.c **** }
 232              		.loc 1 68 0
 233 00ca 05B0     		add	sp, sp, #20
 234              	.LCFI3:
 235              		.cfi_def_cfa_offset 28
 236              		@ sp needed
 237 00cc BDEC048B 		vldm	sp!, {d8-d9}
 238              	.LCFI4:
 239              		.cfi_restore 82
 240              		.cfi_restore 83
 241              		.cfi_restore 80
 242              		.cfi_restore 81
 243              		.cfi_def_cfa_offset 12
 244 00d0 30BD     		pop	{r4, r5, pc}
 245              	.L10:
 246 00d2 00BF     		.align	2
 247              	.L9:
 248 00d4 00000000 		.word	calc
 249 00d8 00007A45 		.word	1165623296
 250 00dc 00009643 		.word	1133903872
 251 00e0 00000000 		.word	.LC0
 252 00e4 00007A44 		.word	1148846080
 253 00e8 00000000 		.word	accel_T
 254 00ec 00000000 		.word	constant_T
 255 00f0 00000000 		.word	decrease_T
 256              		.cfi_endproc
 257              	.LFE161:
 259              		.section	.text.Straight_Calc_Zero,"ax",%progbits
 260              		.align	1
 261              		.global	Straight_Calc_Zero
 262              		.syntax unified
 263              		.thumb
 264              		.thumb_func
 265              		.fpu fpv4-sp-d16
 267              	Straight_Calc_Zero:
 268              	.LFB162:
  69:Src/control.c **** 
  70:Src/control.c **** void Straight_Calc_Zero(void){
 269              		.loc 1 70 0
 270              		.cfi_startproc
 271              		@ args = 0, pretend = 0, frame = 0
 272              		@ frame_needed = 0, uses_anonymous_args = 0
 273              		@ link register save eliminated.
  71:Src/control.c ****     accel_T = 0;
 274              		.loc 1 71 0
 275 0000 0023     		movs	r3, #0
 276 0002 034A     		ldr	r2, .L12
 277 0004 1380     		strh	r3, [r2]	@ movhi
  72:Src/control.c ****     constant_T = 0;
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 7


 278              		.loc 1 72 0
 279 0006 034A     		ldr	r2, .L12+4
 280 0008 1380     		strh	r3, [r2]	@ movhi
  73:Src/control.c ****     decrease_T = 0;
 281              		.loc 1 73 0
 282 000a 034A     		ldr	r2, .L12+8
 283 000c 1380     		strh	r3, [r2]	@ movhi
  74:Src/control.c **** }
 284              		.loc 1 74 0
 285 000e 7047     		bx	lr
 286              	.L13:
 287              		.align	2
 288              	.L12:
 289 0010 00000000 		.word	accel_T
 290 0014 00000000 		.word	constant_T
 291 0018 00000000 		.word	decrease_T
 292              		.cfi_endproc
 293              	.LFE162:
 295              		.section	.text.Straight_SysTic_fb,"ax",%progbits
 296              		.align	1
 297              		.global	Straight_SysTic_fb
 298              		.syntax unified
 299              		.thumb
 300              		.thumb_func
 301              		.fpu fpv4-sp-d16
 303              	Straight_SysTic_fb:
 304              	.LFB163:
  75:Src/control.c **** 
  76:Src/control.c **** /****************************************************************************************
  77:Src/control.c ****  * outline  : output pwm for trapezoid accele straight by feadbuck control
  78:Src/control.c ****  * argument : void
  79:Src/control.c ****  * return   : void
  80:Src/control.c **** ********************************************************************************************/
  81:Src/control.c **** void Straight_SysTic_fb(void){
 305              		.loc 1 81 0
 306              		.cfi_startproc
 307              		@ args = 0, pretend = 0, frame = 0
 308              		@ frame_needed = 0, uses_anonymous_args = 0
 309 0000 38B5     		push	{r3, r4, r5, lr}
 310              	.LCFI5:
 311              		.cfi_def_cfa_offset 16
 312              		.cfi_offset 3, -16
 313              		.cfi_offset 4, -12
 314              		.cfi_offset 5, -8
 315              		.cfi_offset 14, -4
 316 0002 2DED048B 		vpush.64	{d8, d9}
 317              	.LCFI6:
 318              		.cfi_def_cfa_offset 32
 319              		.cfi_offset 80, -32
 320              		.cfi_offset 81, -28
 321              		.cfi_offset 82, -24
 322              		.cfi_offset 83, -20
  82:Src/control.c ****     float encoder_l,encoder_r;
  83:Src/control.c **** 
  84:Src/control.c ****     if(straight_cnt < accel_T){
 323              		.loc 1 84 0
 324 0006 3A4B     		ldr	r3, .L23
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 8


 325 0008 1A88     		ldrh	r2, [r3]
 326 000a 3A4B     		ldr	r3, .L23+4
 327 000c 1B88     		ldrh	r3, [r3]
 328 000e 9A42     		cmp	r2, r3
 329 0010 4BD3     		bcc	.L20
  85:Src/control.c ****         encoder_l = enc.velocity_l;
  86:Src/control.c ****         encoder_r = enc.velocity_r;
  87:Src/control.c ****         Calc_Palam(ACCEL,&calc.velocity,&straight_cnt);
  88:Src/control.c ****     }
  89:Src/control.c ****     else if(straight_cnt < constant_T + accel_T){
 330              		.loc 1 89 0
 331 0012 3949     		ldr	r1, .L23+8
 332 0014 0888     		ldrh	r0, [r1]
 333 0016 C118     		adds	r1, r0, r3
 334 0018 8A42     		cmp	r2, r1
 335 001a 52DB     		blt	.L21
  90:Src/control.c ****         encoder_l = enc.velocity_l;
  91:Src/control.c ****         encoder_r = enc.velocity_r;
  92:Src/control.c ****         Calc_Palam(0,&calc.velocity,&straight_cnt);
  93:Src/control.c ****     }
  94:Src/control.c ****     else if(straight_cnt < decrease_T + constant_T + accel_T){
 336              		.loc 1 94 0
 337 001c 3749     		ldr	r1, .L23+12
 338 001e 0988     		ldrh	r1, [r1]
 339 0020 0144     		add	r1, r1, r0
 340 0022 0B44     		add	r3, r3, r1
 341 0024 9A42     		cmp	r2, r3
 342 0026 57DB     		blt	.L22
  95:Src/control.c ****         encoder_l = enc.velocity_l;
  96:Src/control.c ****         encoder_r = enc.velocity_r;
  97:Src/control.c ****         Calc_Palam(-ACCEL,&calc.velocity,&straight_cnt);
  98:Src/control.c ****     }else{
  99:Src/control.c ****         encoder_l = enc.velocity_c;
 343              		.loc 1 99 0
 344 0028 354B     		ldr	r3, .L23+16
 345 002a 93ED049A 		vldr.32	s18, [r3, #16]
 346              	.LVL28:
 100:Src/control.c ****         encoder_r = enc.velocity_c;
 101:Src/control.c ****         calc.velocity = 0;
 347              		.loc 1 101 0
 348 002e 354B     		ldr	r3, .L23+20
 349 0030 0022     		movs	r2, #0
 350 0032 9A80     		strh	r2, [r3, #4]	@ movhi
 100:Src/control.c ****         encoder_r = enc.velocity_c;
 351              		.loc 1 100 0
 352 0034 F0EE499A 		vmov.f32	s19, s18
 353              	.LVL29:
 354              	.L16:
 102:Src/control.c ****     }
 103:Src/control.c ****     
 104:Src/control.c ****     straight_pid_l = (int16_t)PID_value(calc.velocity,encoder_l,&s_sum_l,&enc.old_l,20.0f,90.0f,0);
 355              		.loc 1 104 0
 356 0038 324D     		ldr	r5, .L23+20
 357 003a B5F90430 		ldrsh	r3, [r5, #4]
 358 003e 00EE103A 		vmov	s0, r3	@ int
 359 0042 DFED318A 		vldr.32	s17, .L23+24
 360 0046 9FED318A 		vldr.32	s16, .L23+28
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 9


 361 004a 314C     		ldr	r4, .L23+32
 362 004c B0EE682A 		vmov.f32	s4, s17
 363 0050 F0EE481A 		vmov.f32	s3, s16
 364 0054 B3EE041A 		vmov.f32	s2, #2.0e+1
 365 0058 2146     		mov	r1, r4
 366 005a 2E48     		ldr	r0, .L23+36
 367 005c F0EE490A 		vmov.f32	s1, s18
 368 0060 B8EEC00A 		vcvt.f32.s32	s0, s0
 369 0064 FFF7FEFF 		bl	PID_value
 370              	.LVL30:
 371 0068 BDEEC00A 		vcvt.s32.f32	s0, s0
 372 006c 2A4B     		ldr	r3, .L23+40
 373 006e 10EE102A 		vmov	r2, s0	@ int
 374 0072 1A80     		strh	r2, [r3]	@ movhi
 105:Src/control.c ****     straight_pid_r = (int16_t)PID_value(calc.velocity,encoder_r,&s_sum_r,&enc.old_r,20.0f,90.0f,0);
 375              		.loc 1 105 0
 376 0074 B5F90430 		ldrsh	r3, [r5, #4]
 377 0078 00EE103A 		vmov	s0, r3	@ int
 378 007c B0EE682A 		vmov.f32	s4, s17
 379 0080 F0EE481A 		vmov.f32	s3, s16
 380 0084 B3EE041A 		vmov.f32	s2, #2.0e+1
 381 0088 211D     		adds	r1, r4, #4
 382 008a 2448     		ldr	r0, .L23+44
 383 008c F0EE690A 		vmov.f32	s1, s19
 384 0090 B8EEC00A 		vcvt.f32.s32	s0, s0
 385 0094 FFF7FEFF 		bl	PID_value
 386              	.LVL31:
 387 0098 BDEEC00A 		vcvt.s32.f32	s0, s0
 388 009c 204B     		ldr	r3, .L23+48
 389 009e 10EE102A 		vmov	r2, s0	@ int
 390 00a2 1A80     		strh	r2, [r3]	@ movhi
 106:Src/control.c **** }
 391              		.loc 1 106 0
 392 00a4 BDEC048B 		vldm	sp!, {d8-d9}
 393              	.LCFI7:
 394              		.cfi_remember_state
 395              		.cfi_restore 82
 396              		.cfi_restore 83
 397              		.cfi_restore 80
 398              		.cfi_restore 81
 399              		.cfi_def_cfa_offset 16
 400              	.LVL32:
 401 00a8 38BD     		pop	{r3, r4, r5, pc}
 402              	.LVL33:
 403              	.L20:
 404              	.LCFI8:
 405              		.cfi_restore_state
  85:Src/control.c ****         encoder_r = enc.velocity_r;
 406              		.loc 1 85 0
 407 00aa 154B     		ldr	r3, .L23+16
 408 00ac 93ED029A 		vldr.32	s18, [r3, #8]
 409              	.LVL34:
  86:Src/control.c ****         Calc_Palam(ACCEL,&calc.velocity,&straight_cnt);
 410              		.loc 1 86 0
 411 00b0 D3ED039A 		vldr.32	s19, [r3, #12]
 412              	.LVL35:
  87:Src/control.c ****     }
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 10


 413              		.loc 1 87 0
 414 00b4 0E4A     		ldr	r2, .L23
 415 00b6 1B49     		ldr	r1, .L23+52
 416 00b8 4FF47A60 		mov	r0, #4000
 417 00bc FFF7FEFF 		bl	Calc_Palam
 418              	.LVL36:
 419 00c0 BAE7     		b	.L16
 420              	.LVL37:
 421              	.L21:
  90:Src/control.c ****         encoder_r = enc.velocity_r;
 422              		.loc 1 90 0
 423 00c2 0F4B     		ldr	r3, .L23+16
 424 00c4 93ED029A 		vldr.32	s18, [r3, #8]
 425              	.LVL38:
  91:Src/control.c ****         Calc_Palam(0,&calc.velocity,&straight_cnt);
 426              		.loc 1 91 0
 427 00c8 D3ED039A 		vldr.32	s19, [r3, #12]
 428              	.LVL39:
  92:Src/control.c ****     }
 429              		.loc 1 92 0
 430 00cc 084A     		ldr	r2, .L23
 431 00ce 1549     		ldr	r1, .L23+52
 432 00d0 0020     		movs	r0, #0
 433 00d2 FFF7FEFF 		bl	Calc_Palam
 434              	.LVL40:
 435 00d6 AFE7     		b	.L16
 436              	.LVL41:
 437              	.L22:
  95:Src/control.c ****         encoder_r = enc.velocity_r;
 438              		.loc 1 95 0
 439 00d8 094B     		ldr	r3, .L23+16
 440 00da 93ED029A 		vldr.32	s18, [r3, #8]
 441              	.LVL42:
  96:Src/control.c ****         Calc_Palam(-ACCEL,&calc.velocity,&straight_cnt);
 442              		.loc 1 96 0
 443 00de D3ED039A 		vldr.32	s19, [r3, #12]
 444              	.LVL43:
  97:Src/control.c ****     }else{
 445              		.loc 1 97 0
 446 00e2 034A     		ldr	r2, .L23
 447 00e4 0F49     		ldr	r1, .L23+52
 448 00e6 1048     		ldr	r0, .L23+56
 449 00e8 FFF7FEFF 		bl	Calc_Palam
 450              	.LVL44:
 451 00ec A4E7     		b	.L16
 452              	.L24:
 453 00ee 00BF     		.align	2
 454              	.L23:
 455 00f0 00000000 		.word	straight_cnt
 456 00f4 00000000 		.word	accel_T
 457 00f8 00000000 		.word	constant_T
 458 00fc 00000000 		.word	decrease_T
 459 0100 00000000 		.word	enc
 460 0104 00000000 		.word	calc
 461 0108 00000000 		.word	0
 462 010c 0000B442 		.word	1119092736
 463 0110 1C000000 		.word	enc+28
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 11


 464 0114 00000000 		.word	s_sum_l
 465 0118 00000000 		.word	straight_pid_l
 466 011c 00000000 		.word	s_sum_r
 467 0120 00000000 		.word	straight_pid_r
 468 0124 04000000 		.word	calc+4
 469 0128 60F0FFFF 		.word	-4000
 470              		.cfi_endproc
 471              	.LFE163:
 473              		.section	.text.Yawrate_Calc_fb,"ax",%progbits
 474              		.align	1
 475              		.global	Yawrate_Calc_fb
 476              		.syntax unified
 477              		.thumb
 478              		.thumb_func
 479              		.fpu fpv4-sp-d16
 481              	Yawrate_Calc_fb:
 482              	.LFB164:
 107:Src/control.c **** 
 108:Src/control.c **** 
 109:Src/control.c **** /****************************************************************************************
 110:Src/control.c ****  * outline  : calcurate trapezoid accel
 111:Src/control.c ****  * argument : degree[degree],v_start[degree/s],v_end[degree/s]
 112:Src/control.c ****  * return   : void
 113:Src/control.c **** ********************************************************************************************/
 114:Src/control.c **** void Yawrate_Calc_fb(int16_t degree,int16_t v_start,int16_t v_end){
 483              		.loc 1 114 0
 484              		.cfi_startproc
 485              		@ args = 0, pretend = 0, frame = 0
 486              		@ frame_needed = 0, uses_anonymous_args = 0
 487              	.LVL45:
 488 0000 30B5     		push	{r4, r5, lr}
 489              	.LCFI9:
 490              		.cfi_def_cfa_offset 12
 491              		.cfi_offset 4, -12
 492              		.cfi_offset 5, -8
 493              		.cfi_offset 14, -4
 494 0002 2DED048B 		vpush.64	{d8, d9}
 495              	.LCFI10:
 496              		.cfi_def_cfa_offset 28
 497              		.cfi_offset 80, -28
 498              		.cfi_offset 81, -24
 499              		.cfi_offset 82, -20
 500              		.cfi_offset 83, -16
 501 0006 85B0     		sub	sp, sp, #20
 502              	.LCFI11:
 503              		.cfi_def_cfa_offset 48
 115:Src/control.c ****     calc.yawrate_velocity = v_start;
 504              		.loc 1 115 0
 505 0008 354B     		ldr	r3, .L27
 506 000a 9981     		strh	r1, [r3, #12]	@ movhi
 507              	.LVL46:
 116:Src/control.c **** 
 117:Src/control.c ****     float t1=0,t2=0,t3=0;
 118:Src/control.c ****     float constant_L;
 119:Src/control.c **** 
 120:Src/control.c ****     t1 = (float)(Y_MAX_VELOCITY - v_start) / Y_ACCEL;
 508              		.loc 1 120 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 12


 509 000c C1F59673 		rsb	r3, r1, #300
 510 0010 07EE903A 		vmov	s15, r3	@ int
 511 0014 F8EEE77A 		vcvt.f32.s32	s15, s15
 512 0018 9FED327A 		vldr.32	s14, .L27+4
 513 001c C7EE878A 		vdiv.f32	s17, s15, s14
 514              	.LVL47:
 121:Src/control.c ****     t3 = (float)(Y_MAX_VELOCITY - v_end) / Y_ACCEL;
 515              		.loc 1 121 0
 516 0020 C2F59673 		rsb	r3, r2, #300
 517 0024 07EE903A 		vmov	s15, r3	@ int
 518 0028 F8EEE77A 		vcvt.f32.s32	s15, s15
 519 002c 87EE878A 		vdiv.f32	s16, s15, s14
 520              	.LVL48:
 122:Src/control.c **** 
 123:Src/control.c ****     constant_L = (float)degree - (Y_MAX_VELOCITY + v_start) * t1 / 2 - (Y_MAX_VELOCITY + v_end) * t
 521              		.loc 1 123 0
 522 0030 07EE900A 		vmov	s15, r0	@ int
 523 0034 B8EEE77A 		vcvt.f32.s32	s14, s15
 524 0038 01F59673 		add	r3, r1, #300
 525 003c 07EE903A 		vmov	s15, r3	@ int
 526 0040 F8EEE77A 		vcvt.f32.s32	s15, s15
 527 0044 67EEA87A 		vmul.f32	s15, s15, s17
 528 0048 F6EE006A 		vmov.f32	s13, #5.0e-1
 529 004c 67EEA67A 		vmul.f32	s15, s15, s13
 530 0050 77EE677A 		vsub.f32	s15, s14, s15
 531 0054 02F59673 		add	r3, r2, #300
 532 0058 07EE103A 		vmov	s14, r3	@ int
 533 005c B8EEC77A 		vcvt.f32.s32	s14, s14
 534 0060 27EE087A 		vmul.f32	s14, s14, s16
 535 0064 27EE267A 		vmul.f32	s14, s14, s13
 536 0068 37EEC77A 		vsub.f32	s14, s15, s14
 537              	.LVL49:
 124:Src/control.c ****     
 125:Src/control.c ****     t2 = constant_L / Y_MAX_VELOCITY;
 538              		.loc 1 125 0
 539 006c DFED1E7A 		vldr.32	s15, .L27+8
 540 0070 87EE279A 		vdiv.f32	s18, s14, s15
 541              	.LVL50:
 126:Src/control.c ****     printf("\nt1:%f,t2:%f,t3%f\r\n",t1,t2,t3);
 542              		.loc 1 126 0
 543 0074 18EE900A 		vmov	r0, s17
 544              	.LVL51:
 545 0078 FFF7FEFF 		bl	__aeabi_f2d
 546              	.LVL52:
 547 007c 0446     		mov	r4, r0
 548 007e 0D46     		mov	r5, r1
 549 0080 18EE100A 		vmov	r0, s16
 550 0084 FFF7FEFF 		bl	__aeabi_f2d
 551              	.LVL53:
 552 0088 CDE90201 		strd	r0, [sp, #8]
 553 008c 19EE100A 		vmov	r0, s18
 554 0090 FFF7FEFF 		bl	__aeabi_f2d
 555              	.LVL54:
 556 0094 CDE90001 		strd	r0, [sp]
 557 0098 2246     		mov	r2, r4
 558 009a 2B46     		mov	r3, r5
 559 009c 1348     		ldr	r0, .L27+12
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 13


 560 009e FFF7FEFF 		bl	printf
 561              	.LVL55:
 127:Src/control.c **** 
 128:Src/control.c ****     t1 *= 1000;
 562              		.loc 1 128 0
 563 00a2 DFED137A 		vldr.32	s15, .L27+16
 564 00a6 68EEA78A 		vmul.f32	s17, s17, s15
 565              	.LVL56:
 129:Src/control.c ****     t2 *= 1000;
 566              		.loc 1 129 0
 567 00aa 29EE279A 		vmul.f32	s18, s18, s15
 568              	.LVL57:
 130:Src/control.c ****     t3 *= 1000;
 569              		.loc 1 130 0
 570 00ae 28EE278A 		vmul.f32	s16, s16, s15
 571              	.LVL58:
 131:Src/control.c **** 
 132:Src/control.c ****     y_accel_T = t1;
 572              		.loc 1 132 0
 573 00b2 FCEEE88A 		vcvt.u32.f32	s17, s17
 574              	.LVL59:
 575 00b6 0F4B     		ldr	r3, .L27+20
 576 00b8 18EE902A 		vmov	r2, s17	@ int
 577 00bc 1A80     		strh	r2, [r3]	@ movhi
 133:Src/control.c ****     y_constant_T = t2;
 578              		.loc 1 133 0
 579 00be BCEEC99A 		vcvt.u32.f32	s18, s18
 580              	.LVL60:
 581 00c2 0D4B     		ldr	r3, .L27+24
 582 00c4 19EE102A 		vmov	r2, s18	@ int
 583 00c8 1A80     		strh	r2, [r3]	@ movhi
 134:Src/control.c ****     y_decrease_T = t3;
 584              		.loc 1 134 0
 585 00ca BCEEC88A 		vcvt.u32.f32	s16, s16
 586              	.LVL61:
 587 00ce 0B4B     		ldr	r3, .L27+28
 588 00d0 18EE102A 		vmov	r2, s16	@ int
 589 00d4 1A80     		strh	r2, [r3]	@ movhi
 135:Src/control.c **** }
 590              		.loc 1 135 0
 591 00d6 05B0     		add	sp, sp, #20
 592              	.LCFI12:
 593              		.cfi_def_cfa_offset 28
 594              		@ sp needed
 595 00d8 BDEC048B 		vldm	sp!, {d8-d9}
 596              	.LCFI13:
 597              		.cfi_restore 82
 598              		.cfi_restore 83
 599              		.cfi_restore 80
 600              		.cfi_restore 81
 601              		.cfi_def_cfa_offset 12
 602 00dc 30BD     		pop	{r4, r5, pc}
 603              	.L28:
 604 00de 00BF     		.align	2
 605              	.L27:
 606 00e0 00000000 		.word	calc
 607 00e4 0000FA44 		.word	1157234688
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 14


 608 00e8 00009643 		.word	1133903872
 609 00ec 00000000 		.word	.LC0
 610 00f0 00007A44 		.word	1148846080
 611 00f4 00000000 		.word	y_accel_T
 612 00f8 00000000 		.word	y_constant_T
 613 00fc 00000000 		.word	y_decrease_T
 614              		.cfi_endproc
 615              	.LFE164:
 617              		.section	.text.Yawrate_Calc_Zero,"ax",%progbits
 618              		.align	1
 619              		.global	Yawrate_Calc_Zero
 620              		.syntax unified
 621              		.thumb
 622              		.thumb_func
 623              		.fpu fpv4-sp-d16
 625              	Yawrate_Calc_Zero:
 626              	.LFB165:
 136:Src/control.c **** 
 137:Src/control.c **** void Yawrate_Calc_Zero(void){
 627              		.loc 1 137 0
 628              		.cfi_startproc
 629              		@ args = 0, pretend = 0, frame = 0
 630              		@ frame_needed = 0, uses_anonymous_args = 0
 631              		@ link register save eliminated.
 138:Src/control.c ****     y_accel_T = 0;
 632              		.loc 1 138 0
 633 0000 0023     		movs	r3, #0
 634 0002 034A     		ldr	r2, .L30
 635 0004 1380     		strh	r3, [r2]	@ movhi
 139:Src/control.c ****     y_constant_T = 0;
 636              		.loc 1 139 0
 637 0006 034A     		ldr	r2, .L30+4
 638 0008 1380     		strh	r3, [r2]	@ movhi
 140:Src/control.c ****     y_decrease_T = 0;
 639              		.loc 1 140 0
 640 000a 034A     		ldr	r2, .L30+8
 641 000c 1380     		strh	r3, [r2]	@ movhi
 141:Src/control.c **** }
 642              		.loc 1 141 0
 643 000e 7047     		bx	lr
 644              	.L31:
 645              		.align	2
 646              	.L30:
 647 0010 00000000 		.word	y_accel_T
 648 0014 00000000 		.word	y_constant_T
 649 0018 00000000 		.word	y_decrease_T
 650              		.cfi_endproc
 651              	.LFE165:
 653              		.section	.text.Yawrate_SysTic_fb,"ax",%progbits
 654              		.align	1
 655              		.global	Yawrate_SysTic_fb
 656              		.syntax unified
 657              		.thumb
 658              		.thumb_func
 659              		.fpu fpv4-sp-d16
 661              	Yawrate_SysTic_fb:
 662              	.LFB166:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 15


 142:Src/control.c **** 
 143:Src/control.c **** /****************************************************************************************
 144:Src/control.c ****  * outline  : call 1ms (roll by feadbuck control)
 145:Src/control.c ****  * argument : void
 146:Src/control.c ****  * return   : void
 147:Src/control.c **** ********************************************************************************************/
 148:Src/control.c **** void Yawrate_SysTic_fb(void){
 663              		.loc 1 148 0
 664              		.cfi_startproc
 665              		@ args = 0, pretend = 0, frame = 0
 666              		@ frame_needed = 0, uses_anonymous_args = 0
 667 0000 08B5     		push	{r3, lr}
 668              	.LCFI14:
 669              		.cfi_def_cfa_offset 8
 670              		.cfi_offset 3, -8
 671              		.cfi_offset 14, -4
 149:Src/control.c ****     if(yawrate_cnt < y_accel_T){
 672              		.loc 1 149 0
 673 0002 214B     		ldr	r3, .L41
 674 0004 1A88     		ldrh	r2, [r3]
 675 0006 214B     		ldr	r3, .L41+4
 676 0008 1B88     		ldrh	r3, [r3]
 677 000a 9A42     		cmp	r2, r3
 678 000c 28D3     		bcc	.L38
 150:Src/control.c ****         Calc_Palam(Y_ACCEL,&calc.yawrate_velocity,&yawrate_cnt);
 151:Src/control.c ****     }else if(yawrate_cnt < y_constant_T + y_accel_T){
 679              		.loc 1 151 0
 680 000e 2049     		ldr	r1, .L41+8
 681 0010 0888     		ldrh	r0, [r1]
 682 0012 C118     		adds	r1, r0, r3
 683 0014 8A42     		cmp	r2, r1
 684 0016 2ADB     		blt	.L39
 152:Src/control.c ****         Calc_Palam(0,&calc.yawrate_velocity,&yawrate_cnt);
 153:Src/control.c ****     }else if(yawrate_cnt < y_decrease_T + y_constant_T + y_accel_T){
 685              		.loc 1 153 0
 686 0018 1E49     		ldr	r1, .L41+12
 687 001a 0988     		ldrh	r1, [r1]
 688 001c 0144     		add	r1, r1, r0
 689 001e 0B44     		add	r3, r3, r1
 690 0020 9A42     		cmp	r2, r3
 691 0022 2ADB     		blt	.L40
 154:Src/control.c ****         Calc_Palam(-Y_ACCEL,&calc.yawrate_velocity,&yawrate_cnt);
 155:Src/control.c ****     }else{
 156:Src/control.c ****         calc.yawrate_velocity = 0;
 692              		.loc 1 156 0
 693 0024 1C4B     		ldr	r3, .L41+16
 694 0026 0022     		movs	r2, #0
 695 0028 9A81     		strh	r2, [r3, #12]	@ movhi
 696              	.L34:
 157:Src/control.c ****     }
 158:Src/control.c ****     yawrate_pid = (int16_t)PID_value((float)calc.yawrate_velocity,gyro.velocity,&gyro.degree,&gyro.
 697              		.loc 1 158 0
 698 002a 1B4B     		ldr	r3, .L41+16
 699 002c B3F90C30 		ldrsh	r3, [r3, #12]
 700 0030 00EE103A 		vmov	s0, r3	@ int
 701 0034 194B     		ldr	r3, .L41+20
 702 0036 B3EE062A 		vmov.f32	s4, #2.2e+1
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 16


 703 003a F7EE001A 		vmov.f32	s3, #1.0e+0
 704 003e B2EE0F1A 		vmov.f32	s2, #1.55e+1
 705 0042 1946     		mov	r1, r3
 706 0044 181D     		adds	r0, r3, #4
 707 0046 D3ED020A 		vldr.32	s1, [r3, #8]
 708 004a B8EEC00A 		vcvt.f32.s32	s0, s0
 709 004e FFF7FEFF 		bl	PID_value
 710              	.LVL62:
 711 0052 BDEEC00A 		vcvt.s32.f32	s0, s0
 712 0056 124B     		ldr	r3, .L41+24
 713 0058 10EE102A 		vmov	r2, s0	@ int
 714 005c 1A80     		strh	r2, [r3]	@ movhi
 159:Src/control.c **** }
 715              		.loc 1 159 0
 716 005e 08BD     		pop	{r3, pc}
 717              	.L38:
 150:Src/control.c ****     }else if(yawrate_cnt < y_constant_T + y_accel_T){
 718              		.loc 1 150 0
 719 0060 094A     		ldr	r2, .L41
 720 0062 1049     		ldr	r1, .L41+28
 721 0064 4FF4FA60 		mov	r0, #2000
 722 0068 FFF7FEFF 		bl	Calc_Palam
 723              	.LVL63:
 724 006c DDE7     		b	.L34
 725              	.L39:
 152:Src/control.c ****     }else if(yawrate_cnt < y_decrease_T + y_constant_T + y_accel_T){
 726              		.loc 1 152 0
 727 006e 064A     		ldr	r2, .L41
 728 0070 0C49     		ldr	r1, .L41+28
 729 0072 0020     		movs	r0, #0
 730 0074 FFF7FEFF 		bl	Calc_Palam
 731              	.LVL64:
 732 0078 D7E7     		b	.L34
 733              	.L40:
 154:Src/control.c ****     }else{
 734              		.loc 1 154 0
 735 007a 034A     		ldr	r2, .L41
 736 007c 0949     		ldr	r1, .L41+28
 737 007e 0A48     		ldr	r0, .L41+32
 738 0080 FFF7FEFF 		bl	Calc_Palam
 739              	.LVL65:
 740 0084 D1E7     		b	.L34
 741              	.L42:
 742 0086 00BF     		.align	2
 743              	.L41:
 744 0088 00000000 		.word	yawrate_cnt
 745 008c 00000000 		.word	y_accel_T
 746 0090 00000000 		.word	y_constant_T
 747 0094 00000000 		.word	y_decrease_T
 748 0098 00000000 		.word	calc
 749 009c 08000000 		.word	gyro+8
 750 00a0 00000000 		.word	yawrate_pid
 751 00a4 0C000000 		.word	calc+12
 752 00a8 30F8FFFF 		.word	-2000
 753              		.cfi_endproc
 754              	.LFE166:
 756              		.section	.text.Control_pwm,"ax",%progbits
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 17


 757              		.align	1
 758              		.global	Control_pwm
 759              		.syntax unified
 760              		.thumb
 761              		.thumb_func
 762              		.fpu fpv4-sp-d16
 764              	Control_pwm:
 765              	.LFB167:
 160:Src/control.c **** 
 161:Src/control.c **** void Control_pwm(void){
 766              		.loc 1 161 0
 767              		.cfi_startproc
 768              		@ args = 0, pretend = 0, frame = 0
 769              		@ frame_needed = 0, uses_anonymous_args = 0
 770 0000 08B5     		push	{r3, lr}
 771              	.LCFI15:
 772              		.cfi_def_cfa_offset 8
 773              		.cfi_offset 3, -8
 774              		.cfi_offset 14, -4
 775              	.LVL66:
 162:Src/control.c ****     int16_t pwm_l=0,pwm_r=0;
 163:Src/control.c **** 
 164:Src/control.c ****     if(flag.straight==ON){
 776              		.loc 1 164 0
 777 0002 0E4B     		ldr	r3, .L50
 778 0004 B3F90230 		ldrsh	r3, [r3, #2]
 779 0008 012B     		cmp	r3, #1
 780 000a 09D0     		beq	.L48
 162:Src/control.c ****     int16_t pwm_l=0,pwm_r=0;
 781              		.loc 1 162 0
 782 000c 0021     		movs	r1, #0
 783 000e 0846     		mov	r0, r1
 784              	.LVL67:
 785              	.L44:
 165:Src/control.c ****         pwm_l += straight_pid_l;
 166:Src/control.c ****         pwm_r += straight_pid_r;
 167:Src/control.c ****     }
 168:Src/control.c ****     if(flag.yawrate==ON){
 786              		.loc 1 168 0
 787 0010 0A4B     		ldr	r3, .L50
 788 0012 B3F90430 		ldrsh	r3, [r3, #4]
 789 0016 012B     		cmp	r3, #1
 790 0018 09D0     		beq	.L49
 791              	.L45:
 169:Src/control.c ****         pwm_l -= yawrate_pid;
 170:Src/control.c ****         pwm_r += yawrate_pid;
 171:Src/control.c ****     }
 172:Src/control.c ****     Motor_pwm(pwm_l,pwm_r);
 792              		.loc 1 172 0
 793 001a FFF7FEFF 		bl	Motor_pwm
 794              	.LVL68:
 173:Src/control.c **** }
 795              		.loc 1 173 0
 796 001e 08BD     		pop	{r3, pc}
 797              	.LVL69:
 798              	.L48:
 165:Src/control.c ****         pwm_l += straight_pid_l;
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 18


 799              		.loc 1 165 0
 800 0020 074B     		ldr	r3, .L50+4
 801 0022 B3F90000 		ldrsh	r0, [r3]
 802              	.LVL70:
 166:Src/control.c ****     }
 803              		.loc 1 166 0
 804 0026 074B     		ldr	r3, .L50+8
 805 0028 B3F90010 		ldrsh	r1, [r3]
 806              	.LVL71:
 807 002c F0E7     		b	.L44
 808              	.L49:
 169:Src/control.c ****         pwm_l -= yawrate_pid;
 809              		.loc 1 169 0
 810 002e 064B     		ldr	r3, .L50+12
 811 0030 1B88     		ldrh	r3, [r3]
 812 0032 C01A     		subs	r0, r0, r3
 813              	.LVL72:
 814 0034 00B2     		sxth	r0, r0
 815              	.LVL73:
 170:Src/control.c ****     }
 816              		.loc 1 170 0
 817 0036 1944     		add	r1, r1, r3
 818              	.LVL74:
 819 0038 09B2     		sxth	r1, r1
 820              	.LVL75:
 821 003a EEE7     		b	.L45
 822              	.L51:
 823              		.align	2
 824              	.L50:
 825 003c 00000000 		.word	flag
 826 0040 00000000 		.word	straight_pid_l
 827 0044 00000000 		.word	straight_pid_r
 828 0048 00000000 		.word	yawrate_pid
 829              		.cfi_endproc
 830              	.LFE167:
 832              		.section	.text.Output_Buzzer,"ax",%progbits
 833              		.align	1
 834              		.global	Output_Buzzer
 835              		.syntax unified
 836              		.thumb
 837              		.thumb_func
 838              		.fpu fpv4-sp-d16
 840              	Output_Buzzer:
 841              	.LFB168:
 174:Src/control.c **** /****************************************************************************************
 175:Src/control.c ****  * outline  : turn on buzzer 0.3sec
 176:Src/control.c ****  * argument : Hz
 177:Src/control.c ****  * return   : void
 178:Src/control.c **** ********************************************************************************************/
 179:Src/control.c **** void Output_Buzzer(uint8_t Hz){
 842              		.loc 1 179 0
 843              		.cfi_startproc
 844              		@ args = 0, pretend = 0, frame = 0
 845              		@ frame_needed = 0, uses_anonymous_args = 0
 846              	.LVL76:
 847 0000 08B5     		push	{r3, lr}
 848              	.LCFI16:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 19


 849              		.cfi_def_cfa_offset 8
 850              		.cfi_offset 3, -8
 851              		.cfi_offset 14, -4
 180:Src/control.c ****     Buzzer_pwm(Hz,300);
 852              		.loc 1 180 0
 853 0002 4FF49671 		mov	r1, #300
 854 0006 FFF7FEFF 		bl	Buzzer_pwm
 855              	.LVL77:
 181:Src/control.c ****     HAL_Delay(300);
 856              		.loc 1 181 0
 857 000a 4FF49670 		mov	r0, #300
 858 000e FFF7FEFF 		bl	HAL_Delay
 859              	.LVL78:
 182:Src/control.c ****     Buzzer_pwm(HZ_NORMAL,0);
 860              		.loc 1 182 0
 861 0012 0021     		movs	r1, #0
 862 0014 0A20     		movs	r0, #10
 863 0016 FFF7FEFF 		bl	Buzzer_pwm
 864              	.LVL79:
 183:Src/control.c **** }
 865              		.loc 1 183 0
 866 001a 08BD     		pop	{r3, pc}
 867              		.cfi_endproc
 868              	.LFE168:
 870              		.section	.text.Sensor_Check,"ax",%progbits
 871              		.align	1
 872              		.global	Sensor_Check
 873              		.syntax unified
 874              		.thumb
 875              		.thumb_func
 876              		.fpu fpv4-sp-d16
 878              	Sensor_Check:
 879              	.LFB169:
 184:Src/control.c **** 
 185:Src/control.c **** 
 186:Src/control.c **** /****************************************************************************************
 187:Src/control.c ****  * outline  : sensor check
 188:Src/control.c ****  * argument : void
 189:Src/control.c ****  * return   : void
 190:Src/control.c **** ********************************************************************************************/
 191:Src/control.c **** void Sensor_Check(void){
 880              		.loc 1 191 0
 881              		.cfi_startproc
 882              		@ args = 0, pretend = 0, frame = 0
 883              		@ frame_needed = 0, uses_anonymous_args = 0
 884 0000 08B5     		push	{r3, lr}
 885              	.LCFI17:
 886              		.cfi_def_cfa_offset 8
 887              		.cfi_offset 3, -8
 888              		.cfi_offset 14, -4
 192:Src/control.c ****     if(sensor.wall[0]==true){
 889              		.loc 1 192 0
 890 0002 214B     		ldr	r3, .L68
 891 0004 1B7E     		ldrb	r3, [r3, #24]	@ zero_extendqisi2
 892 0006 012B     		cmp	r3, #1
 893 0008 23D0     		beq	.L64
 193:Src/control.c ****         HAL_GPIO_WritePin(led0_GPIO_Port,led0_Pin,GPIO_PIN_RESET);
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 20


 194:Src/control.c ****     }else{
 195:Src/control.c ****         HAL_GPIO_WritePin(led0_GPIO_Port,led0_Pin,GPIO_PIN_SET);
 894              		.loc 1 195 0
 895 000a 0122     		movs	r2, #1
 896 000c 4FF40051 		mov	r1, #8192
 897 0010 1E48     		ldr	r0, .L68+4
 898 0012 FFF7FEFF 		bl	HAL_GPIO_WritePin
 899              	.LVL80:
 900              	.L56:
 196:Src/control.c ****     }
 197:Src/control.c ****     if(sensor.wall[1]==true){
 901              		.loc 1 197 0
 902 0016 1C4B     		ldr	r3, .L68
 903 0018 5B7E     		ldrb	r3, [r3, #25]	@ zero_extendqisi2
 904 001a 012B     		cmp	r3, #1
 905 001c 20D0     		beq	.L65
 198:Src/control.c ****         HAL_GPIO_WritePin(led3_GPIO_Port,led3_Pin,GPIO_PIN_RESET);
 199:Src/control.c ****     }else{
 200:Src/control.c ****         HAL_GPIO_WritePin(led3_GPIO_Port,led3_Pin,GPIO_PIN_SET);
 906              		.loc 1 200 0
 907 001e 0122     		movs	r2, #1
 908 0020 4FF48071 		mov	r1, #256
 909 0024 1948     		ldr	r0, .L68+4
 910 0026 FFF7FEFF 		bl	HAL_GPIO_WritePin
 911              	.LVL81:
 912              	.L58:
 201:Src/control.c ****     }
 202:Src/control.c ****     if(sensor.wall[2]==true){
 913              		.loc 1 202 0
 914 002a 174B     		ldr	r3, .L68
 915 002c 9B7E     		ldrb	r3, [r3, #26]	@ zero_extendqisi2
 916 002e 012B     		cmp	r3, #1
 917 0030 1DD0     		beq	.L66
 203:Src/control.c ****         HAL_GPIO_WritePin(led2_GPIO_Port,led2_Pin,GPIO_PIN_RESET);
 204:Src/control.c ****     }else{
 205:Src/control.c ****         HAL_GPIO_WritePin(led2_GPIO_Port,led2_Pin,GPIO_PIN_SET);
 918              		.loc 1 205 0
 919 0032 0122     		movs	r2, #1
 920 0034 8021     		movs	r1, #128
 921 0036 1548     		ldr	r0, .L68+4
 922 0038 FFF7FEFF 		bl	HAL_GPIO_WritePin
 923              	.LVL82:
 924              	.L60:
 206:Src/control.c ****     }
 207:Src/control.c ****     if(sensor.wall[3]==true){
 925              		.loc 1 207 0
 926 003c 124B     		ldr	r3, .L68
 927 003e DB7E     		ldrb	r3, [r3, #27]	@ zero_extendqisi2
 928 0040 012B     		cmp	r3, #1
 929 0042 1AD0     		beq	.L67
 208:Src/control.c ****         HAL_GPIO_WritePin(led1_GPIO_Port,led1_Pin,GPIO_PIN_RESET);
 209:Src/control.c ****     }else{
 210:Src/control.c ****         HAL_GPIO_WritePin(led1_GPIO_Port,led1_Pin,GPIO_PIN_SET);
 930              		.loc 1 210 0
 931 0044 0122     		movs	r2, #1
 932 0046 4FF48041 		mov	r1, #16384
 933 004a 1048     		ldr	r0, .L68+4
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 21


 934 004c FFF7FEFF 		bl	HAL_GPIO_WritePin
 935              	.LVL83:
 936              	.L54:
 211:Src/control.c ****     } 
 212:Src/control.c **** }
 937              		.loc 1 212 0
 938 0050 08BD     		pop	{r3, pc}
 939              	.L64:
 193:Src/control.c ****     }else{
 940              		.loc 1 193 0
 941 0052 0022     		movs	r2, #0
 942 0054 4FF40051 		mov	r1, #8192
 943 0058 0C48     		ldr	r0, .L68+4
 944 005a FFF7FEFF 		bl	HAL_GPIO_WritePin
 945              	.LVL84:
 946 005e DAE7     		b	.L56
 947              	.L65:
 198:Src/control.c ****     }else{
 948              		.loc 1 198 0
 949 0060 0022     		movs	r2, #0
 950 0062 4FF48071 		mov	r1, #256
 951 0066 0948     		ldr	r0, .L68+4
 952 0068 FFF7FEFF 		bl	HAL_GPIO_WritePin
 953              	.LVL85:
 954 006c DDE7     		b	.L58
 955              	.L66:
 203:Src/control.c ****     }else{
 956              		.loc 1 203 0
 957 006e 0022     		movs	r2, #0
 958 0070 8021     		movs	r1, #128
 959 0072 0648     		ldr	r0, .L68+4
 960 0074 FFF7FEFF 		bl	HAL_GPIO_WritePin
 961              	.LVL86:
 962 0078 E0E7     		b	.L60
 963              	.L67:
 208:Src/control.c ****     }else{
 964              		.loc 1 208 0
 965 007a 0022     		movs	r2, #0
 966 007c 4FF48041 		mov	r1, #16384
 967 0080 0248     		ldr	r0, .L68+4
 968 0082 FFF7FEFF 		bl	HAL_GPIO_WritePin
 969              	.LVL87:
 970 0086 E3E7     		b	.L54
 971              	.L69:
 972              		.align	2
 973              	.L68:
 974 0088 00000000 		.word	sensor
 975 008c 00080240 		.word	1073874944
 976              		.cfi_endproc
 977              	.LFE169:
 979              		.comm	yawrate_pid,2,2
 980              		.comm	straight_pid_r,2,2
 981              		.comm	straight_pid_l,2,2
 982              		.comm	y_sum,4,4
 983              		.comm	s_sum_r,4,4
 984              		.comm	s_sum_l,4,4
 985              		.section	.rodata.Straight_Calc_fb.str1.4,"aMS",%progbits,1
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 22


 986              		.align	2
 987              	.LC0:
 988 0000 0A74313A 		.ascii	"\012t1:%f,t2:%f,t3%f\015\012\000"
 988      25662C74 
 988      323A2566 
 988      2C743325 
 988      660D0A00 
 989              		.text
 990              	.Letext0:
 991              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 992              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 993              		.file 4 "Inc/control.h"
 994              		.file 5 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 995              		.file 6 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 996              		.file 7 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\lib\\gcc\\arm-none-eabi
 997              		.file 8 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 998              		.file 9 "Inc/global.h"
 999              		.file 10 "Drivers/CMSIS/Include/core_cm4.h"
 1000              		.file 11 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 1001              		.file 12 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f405xx.h"
 1002              		.file 13 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 1003              		.file 14 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 1004              		.file 15 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 1005              		.file 16 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 1006              		.file 17 "Inc/tim.h"
 1007              		.file 18 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
 1008              		.file 19 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 1009              		.file 20 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 23


DEFINED SYMBOLS
                            *ABS*:00000000 control.c
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:18     .text.PID_value:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:25     .text.PID_value:00000000 PID_value
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:70     .text.PID_value:00000040 $d
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:76     .text.Calc_Palam:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:83     .text.Calc_Palam:00000000 Calc_Palam
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:112    .text.Calc_Palam:00000034 $d
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:118    .text.Straight_Calc_fb:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:125    .text.Straight_Calc_fb:00000000 Straight_Calc_fb
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:248    .text.Straight_Calc_fb:000000d4 $d
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:260    .text.Straight_Calc_Zero:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:267    .text.Straight_Calc_Zero:00000000 Straight_Calc_Zero
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:289    .text.Straight_Calc_Zero:00000010 $d
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:296    .text.Straight_SysTic_fb:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:303    .text.Straight_SysTic_fb:00000000 Straight_SysTic_fb
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:455    .text.Straight_SysTic_fb:000000f0 $d
                            *COM*:00000004 s_sum_l
                            *COM*:00000002 straight_pid_l
                            *COM*:00000004 s_sum_r
                            *COM*:00000002 straight_pid_r
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:474    .text.Yawrate_Calc_fb:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:481    .text.Yawrate_Calc_fb:00000000 Yawrate_Calc_fb
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:606    .text.Yawrate_Calc_fb:000000e0 $d
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:618    .text.Yawrate_Calc_Zero:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:625    .text.Yawrate_Calc_Zero:00000000 Yawrate_Calc_Zero
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:647    .text.Yawrate_Calc_Zero:00000010 $d
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:654    .text.Yawrate_SysTic_fb:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:661    .text.Yawrate_SysTic_fb:00000000 Yawrate_SysTic_fb
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:744    .text.Yawrate_SysTic_fb:00000088 $d
                            *COM*:00000002 yawrate_pid
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:757    .text.Control_pwm:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:764    .text.Control_pwm:00000000 Control_pwm
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:825    .text.Control_pwm:0000003c $d
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:833    .text.Output_Buzzer:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:840    .text.Output_Buzzer:00000000 Output_Buzzer
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:871    .text.Sensor_Check:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:878    .text.Sensor_Check:00000000 Sensor_Check
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:974    .text.Sensor_Check:00000088 $d
                            *COM*:00000004 y_sum
C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s:986    .rodata.Straight_Calc_fb.str1.4:00000000 $d

UNDEFINED SYMBOLS
batt_Vcc
__aeabi_f2d
printf
calc
accel_T
constant_T
decrease_T
straight_cnt
enc
y_accel_T
y_constant_T
y_decrease_T
yawrate_cnt
gyro
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccrbVO3K.s 			page 24


Motor_pwm
flag
Buzzer_pwm
HAL_Delay
HAL_GPIO_WritePin
sensor
