ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"control.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.PID_value,"ax",%progbits
  18              		.align	1
  19              		.global	PID_value
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	PID_value:
  26              	.LFB159:
  27              		.file 1 "Src/control.c"
   1:Src/control.c **** #include "control.h"
   2:Src/control.c **** #include <stdint.h>
   3:Src/control.c **** #include "global.h"
   4:Src/control.c **** #include "tim.h"
   5:Src/control.c **** #include "arm_math.h"
   6:Src/control.c **** #include "main.h"
   7:Src/control.c **** #include "stm32f4xx_hal.h"
   8:Src/control.c **** 
   9:Src/control.c **** float encoder_Kp = 0;
  10:Src/control.c **** float encoder_Ki = 0;
  11:Src/control.c **** float encoder_Kd = 0;
  12:Src/control.c **** 
  13:Src/control.c **** 
  14:Src/control.c **** /****************************************************************************************
  15:Src/control.c ****  * outline  : PID control
  16:Src/control.c ****  * argument : 
  17:Src/control.c ****  * return   : control value
  18:Src/control.c **** ********************************************************************************************/
  19:Src/control.c **** float PID_value(float target,float measured,float *sum,float*old,float Kp,float Ki,float Kd){
  28              		.loc 1 19 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33              	.LVL0:
  20:Src/control.c ****     float error;
  21:Src/control.c ****     float p,i,d;
  22:Src/control.c **** 
  23:Src/control.c ****     error = target - measured;
  34              		.loc 1 23 0
  35 0000 30EE600A 		vsub.f32	s0, s0, s1
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 2


  36              	.LVL1:
  24:Src/control.c ****     p = Kp*error;
  37              		.loc 1 24 0
  38 0004 20EE011A 		vmul.f32	s2, s0, s2
  39              	.LVL2:
  25:Src/control.c **** 
  26:Src/control.c ****     *sum += error * dt;
  40              		.loc 1 26 0
  41 0008 DFED0D7A 		vldr.32	s15, .L2
  42 000c 20EE270A 		vmul.f32	s0, s0, s15
  43              	.LVL3:
  44 0010 D0ED007A 		vldr.32	s15, [r0]
  45 0014 30EE270A 		vadd.f32	s0, s0, s15
  46 0018 80ED000A 		vstr.32	s0, [r0]
  27:Src/control.c ****     i = Ki * *sum;
  47              		.loc 1 27 0
  48 001c 20EE210A 		vmul.f32	s0, s0, s3
  49              	.LVL4:
  28:Src/control.c **** 
  29:Src/control.c ****     *old = measured;
  50              		.loc 1 29 0
  51 0020 C1ED000A 		vstr.32	s1, [r1]
  30:Src/control.c ****     d = Kd * (measured - *old);
  52              		.loc 1 30 0
  53 0024 70EEE00A 		vsub.f32	s1, s1, s1
  54              	.LVL5:
  55 0028 60EE820A 		vmul.f32	s1, s1, s4
  56              	.LVL6:
  31:Src/control.c **** 
  32:Src/control.c ****     return (p+i+d)/batt_Vcc;
  57              		.loc 1 32 0
  58 002c 31EE000A 		vadd.f32	s0, s2, s0
  59              	.LVL7:
  60 0030 70EE200A 		vadd.f32	s1, s0, s1
  61              	.LVL8:
  62 0034 034B     		ldr	r3, .L2+4
  63 0036 93ED000A 		vldr.32	s0, [r3]
  33:Src/control.c **** }
  64              		.loc 1 33 0
  65 003a 80EE800A 		vdiv.f32	s0, s1, s0
  66 003e 7047     		bx	lr
  67              	.L3:
  68              		.align	2
  69              	.L2:
  70 0040 6F12833A 		.word	981668463
  71 0044 00000000 		.word	batt_Vcc
  72              		.cfi_endproc
  73              	.LFE159:
  75              		.section	.text.Calc_Palam,"ax",%progbits
  76              		.align	1
  77              		.global	Calc_Palam
  78              		.syntax unified
  79              		.thumb
  80              		.thumb_func
  81              		.fpu fpv4-sp-d16
  83              	Calc_Palam:
  84              	.LFB160:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 3


  34:Src/control.c **** 
  35:Src/control.c **** /****************************************************************************************
  36:Src/control.c ****  * outline  : calculate parameter
  37:Src/control.c ****  * argument : accel,*velocity,*distance
  38:Src/control.c ****  * return   : void
  39:Src/control.c **** ********************************************************************************************/
  40:Src/control.c **** void Calc_Palam(int16_t accel,int16_t *velocity,uint16_t *calc_tim){
  85              		.loc 1 40 0
  86              		.cfi_startproc
  87              		@ args = 0, pretend = 0, frame = 0
  88              		@ frame_needed = 0, uses_anonymous_args = 0
  89              		@ link register save eliminated.
  90              	.LVL9:
  41:Src/control.c ****     *calc_tim += 1;
  91              		.loc 1 41 0
  92 0000 1388     		ldrh	r3, [r2]
  93 0002 0133     		adds	r3, r3, #1
  94 0004 1380     		strh	r3, [r2]	@ movhi
  42:Src/control.c ****     *velocity += accel * dt;
  95              		.loc 1 42 0
  96 0006 07EE900A 		vmov	s15, r0	@ int
  97 000a F8EEE77A 		vcvt.f32.s32	s15, s15
  98 000e 9FED097A 		vldr.32	s14, .L5
  99 0012 27EE877A 		vmul.f32	s14, s15, s14
 100 0016 B1F90030 		ldrsh	r3, [r1]
 101 001a 07EE903A 		vmov	s15, r3	@ int
 102 001e F8EEE77A 		vcvt.f32.s32	s15, s15
 103 0022 77EE877A 		vadd.f32	s15, s15, s14
 104 0026 FDEEE77A 		vcvt.s32.f32	s15, s15
 105 002a 17EE903A 		vmov	r3, s15	@ int
 106 002e 0B80     		strh	r3, [r1]	@ movhi
  43:Src/control.c **** }
 107              		.loc 1 43 0
 108 0030 7047     		bx	lr
 109              	.L6:
 110 0032 00BF     		.align	2
 111              	.L5:
 112 0034 6F12833A 		.word	981668463
 113              		.cfi_endproc
 114              	.LFE160:
 116              		.global	__aeabi_f2d
 117              		.section	.text.Straight_Calc_fb,"ax",%progbits
 118              		.align	1
 119              		.global	Straight_Calc_fb
 120              		.syntax unified
 121              		.thumb
 122              		.thumb_func
 123              		.fpu fpv4-sp-d16
 125              	Straight_Calc_fb:
 126              	.LFB161:
  44:Src/control.c **** 
  45:Src/control.c **** 
  46:Src/control.c **** /****************************************************************************************
  47:Src/control.c ****  * outline  : calcurate accele distance
  48:Src/control.c ****  * argument : distance[mm],v_start[mm/s],v_end[mm/s]
  49:Src/control.c ****  * return   : void
  50:Src/control.c **** ********************************************************************************************/
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 4


  51:Src/control.c **** void Straight_Calc_fb(int16_t distant,int16_t v_start,int16_t v_end){
 127              		.loc 1 51 0
 128              		.cfi_startproc
 129              		@ args = 0, pretend = 0, frame = 0
 130              		@ frame_needed = 0, uses_anonymous_args = 0
 131              	.LVL10:
 132 0000 30B5     		push	{r4, r5, lr}
 133              	.LCFI0:
 134              		.cfi_def_cfa_offset 12
 135              		.cfi_offset 4, -12
 136              		.cfi_offset 5, -8
 137              		.cfi_offset 14, -4
 138 0002 2DED048B 		vpush.64	{d8, d9}
 139              	.LCFI1:
 140              		.cfi_def_cfa_offset 28
 141              		.cfi_offset 80, -28
 142              		.cfi_offset 81, -24
 143              		.cfi_offset 82, -20
 144              		.cfi_offset 83, -16
 145 0006 85B0     		sub	sp, sp, #20
 146              	.LCFI2:
 147              		.cfi_def_cfa_offset 48
  52:Src/control.c ****     float t1,t2,t3;
  53:Src/control.c ****     float constant_L;
  54:Src/control.c ****     calc.velocity = v_start;
 148              		.loc 1 54 0
 149 0008 364B     		ldr	r3, .L9
 150 000a 9980     		strh	r1, [r3, #4]	@ movhi
  55:Src/control.c ****     t1 = (float)(MAX_VELOCITY - v_start) / ACCEL;
 151              		.loc 1 55 0
 152 000c C1F59673 		rsb	r3, r1, #300
 153 0010 07EE903A 		vmov	s15, r3	@ int
 154 0014 F8EEE77A 		vcvt.f32.s32	s15, s15
 155 0018 9FED337A 		vldr.32	s14, .L9+4
 156 001c C7EE878A 		vdiv.f32	s17, s15, s14
 157              	.LVL11:
  56:Src/control.c ****     t3 = (float)(MAX_VELOCITY - v_end) / ACCEL;
 158              		.loc 1 56 0
 159 0020 C2F59672 		rsb	r2, r2, #300
 160              	.LVL12:
 161 0024 07EE902A 		vmov	s15, r2	@ int
 162 0028 F8EEE77A 		vcvt.f32.s32	s15, s15
 163 002c 87EE878A 		vdiv.f32	s16, s15, s14
 164              	.LVL13:
  57:Src/control.c **** 
  58:Src/control.c ****     constant_L = (float)distant - (MAX_VELOCITY + v_start) * t1 / 2 - (MAX_VELOCITY + v_start) * t3
 165              		.loc 1 58 0
 166 0030 07EE900A 		vmov	s15, r0	@ int
 167 0034 B8EEE77A 		vcvt.f32.s32	s14, s15
 168 0038 01F59671 		add	r1, r1, #300
 169              	.LVL14:
 170 003c 07EE901A 		vmov	s15, r1	@ int
 171 0040 F8EEE77A 		vcvt.f32.s32	s15, s15
 172 0044 67EEA86A 		vmul.f32	s13, s15, s17
 173 0048 B6EE006A 		vmov.f32	s12, #5.0e-1
 174 004c 66EE866A 		vmul.f32	s13, s13, s12
 175 0050 37EE667A 		vsub.f32	s14, s14, s13
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 5


 176 0054 67EE887A 		vmul.f32	s15, s15, s16
 177 0058 67EE867A 		vmul.f32	s15, s15, s12
 178 005c 77EE677A 		vsub.f32	s15, s14, s15
 179              	.LVL15:
  59:Src/control.c **** 
  60:Src/control.c ****     t2 = constant_L / MAX_VELOCITY;
 180              		.loc 1 60 0
 181 0060 9FED227A 		vldr.32	s14, .L9+8
 182 0064 87EE879A 		vdiv.f32	s18, s15, s14
 183              	.LVL16:
  61:Src/control.c ****     printf("\nt1:%f,t2:%f,t3%f\r\n",t1,t2,t3);
 184              		.loc 1 61 0
 185 0068 18EE900A 		vmov	r0, s17
 186              	.LVL17:
 187 006c FFF7FEFF 		bl	__aeabi_f2d
 188              	.LVL18:
 189 0070 0446     		mov	r4, r0
 190 0072 0D46     		mov	r5, r1
 191 0074 18EE100A 		vmov	r0, s16
 192 0078 FFF7FEFF 		bl	__aeabi_f2d
 193              	.LVL19:
 194 007c CDE90201 		strd	r0, [sp, #8]
 195 0080 19EE100A 		vmov	r0, s18
 196 0084 FFF7FEFF 		bl	__aeabi_f2d
 197              	.LVL20:
 198 0088 CDE90001 		strd	r0, [sp]
 199 008c 2246     		mov	r2, r4
 200 008e 2B46     		mov	r3, r5
 201 0090 1748     		ldr	r0, .L9+12
 202 0092 FFF7FEFF 		bl	printf
 203              	.LVL21:
  62:Src/control.c **** 
  63:Src/control.c ****     t1 *= 1000;
 204              		.loc 1 63 0
 205 0096 DFED177A 		vldr.32	s15, .L9+16
 206 009a 68EEA78A 		vmul.f32	s17, s17, s15
 207              	.LVL22:
  64:Src/control.c ****     t2 *= 1000;
 208              		.loc 1 64 0
 209 009e 29EE279A 		vmul.f32	s18, s18, s15
 210              	.LVL23:
  65:Src/control.c ****     t3 *= 1000;
 211              		.loc 1 65 0
 212 00a2 28EE278A 		vmul.f32	s16, s16, s15
 213              	.LVL24:
  66:Src/control.c **** 
  67:Src/control.c ****     accel_T = t1;
 214              		.loc 1 67 0
 215 00a6 FCEEE88A 		vcvt.u32.f32	s17, s17
 216              	.LVL25:
 217 00aa 134B     		ldr	r3, .L9+20
 218 00ac 18EE902A 		vmov	r2, s17	@ int
 219 00b0 1A80     		strh	r2, [r3]	@ movhi
  68:Src/control.c ****     constant_T = t2;
 220              		.loc 1 68 0
 221 00b2 BCEEC99A 		vcvt.u32.f32	s18, s18
 222              	.LVL26:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 6


 223 00b6 114B     		ldr	r3, .L9+24
 224 00b8 19EE102A 		vmov	r2, s18	@ int
 225 00bc 1A80     		strh	r2, [r3]	@ movhi
  69:Src/control.c ****     decrease_T = t3;
 226              		.loc 1 69 0
 227 00be BCEEC88A 		vcvt.u32.f32	s16, s16
 228              	.LVL27:
 229 00c2 0F4B     		ldr	r3, .L9+28
 230 00c4 18EE102A 		vmov	r2, s16	@ int
 231 00c8 1A80     		strh	r2, [r3]	@ movhi
  70:Src/control.c **** 
  71:Src/control.c ****     encoder_Kp = 20;
 232              		.loc 1 71 0
 233 00ca 0E4B     		ldr	r3, .L9+32
 234 00cc 0E4A     		ldr	r2, .L9+36
 235 00ce 1A60     		str	r2, [r3]	@ float
  72:Src/control.c ****     encoder_Ki = 90;
 236              		.loc 1 72 0
 237 00d0 0E4B     		ldr	r3, .L9+40
 238 00d2 0F4A     		ldr	r2, .L9+44
 239 00d4 1A60     		str	r2, [r3]	@ float
  73:Src/control.c ****     encoder_Kd = 0;
 240              		.loc 1 73 0
 241 00d6 0F4B     		ldr	r3, .L9+48
 242 00d8 0022     		movs	r2, #0
 243 00da 1A60     		str	r2, [r3]	@ float
  74:Src/control.c **** }
 244              		.loc 1 74 0
 245 00dc 05B0     		add	sp, sp, #20
 246              	.LCFI3:
 247              		.cfi_def_cfa_offset 28
 248              		@ sp needed
 249 00de BDEC048B 		vldm	sp!, {d8-d9}
 250              	.LCFI4:
 251              		.cfi_restore 82
 252              		.cfi_restore 83
 253              		.cfi_restore 80
 254              		.cfi_restore 81
 255              		.cfi_def_cfa_offset 12
 256 00e2 30BD     		pop	{r4, r5, pc}
 257              	.L10:
 258              		.align	2
 259              	.L9:
 260 00e4 00000000 		.word	calc
 261 00e8 00007A45 		.word	1165623296
 262 00ec 00009643 		.word	1133903872
 263 00f0 00000000 		.word	.LC0
 264 00f4 00007A44 		.word	1148846080
 265 00f8 00000000 		.word	accel_T
 266 00fc 00000000 		.word	constant_T
 267 0100 00000000 		.word	decrease_T
 268 0104 00000000 		.word	.LANCHOR0
 269 0108 0000A041 		.word	1101004800
 270 010c 00000000 		.word	.LANCHOR1
 271 0110 0000B442 		.word	1119092736
 272 0114 00000000 		.word	.LANCHOR2
 273              		.cfi_endproc
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 7


 274              	.LFE161:
 276              		.section	.text.Straight_Calc_Zero,"ax",%progbits
 277              		.align	1
 278              		.global	Straight_Calc_Zero
 279              		.syntax unified
 280              		.thumb
 281              		.thumb_func
 282              		.fpu fpv4-sp-d16
 284              	Straight_Calc_Zero:
 285              	.LFB162:
  75:Src/control.c **** 
  76:Src/control.c **** void Straight_Calc_Zero(void){
 286              		.loc 1 76 0
 287              		.cfi_startproc
 288              		@ args = 0, pretend = 0, frame = 0
 289              		@ frame_needed = 0, uses_anonymous_args = 0
 290              		@ link register save eliminated.
  77:Src/control.c ****     accel_T = 0;
 291              		.loc 1 77 0
 292 0000 0023     		movs	r3, #0
 293 0002 084A     		ldr	r2, .L12
 294 0004 1380     		strh	r3, [r2]	@ movhi
  78:Src/control.c ****     constant_T = 0;
 295              		.loc 1 78 0
 296 0006 084A     		ldr	r2, .L12+4
 297 0008 1380     		strh	r3, [r2]	@ movhi
  79:Src/control.c ****     decrease_T = 0;
 298              		.loc 1 79 0
 299 000a 084A     		ldr	r2, .L12+8
 300 000c 1380     		strh	r3, [r2]	@ movhi
  80:Src/control.c ****     encoder_Kp = 20;
 301              		.loc 1 80 0
 302 000e 084B     		ldr	r3, .L12+12
 303 0010 084A     		ldr	r2, .L12+16
 304 0012 1A60     		str	r2, [r3]	@ float
  81:Src/control.c ****     encoder_Ki = 0;
 305              		.loc 1 81 0
 306 0014 084B     		ldr	r3, .L12+20
 307 0016 0022     		movs	r2, #0
 308 0018 1A60     		str	r2, [r3]	@ float
  82:Src/control.c ****     encoder_Kd = 10;
 309              		.loc 1 82 0
 310 001a 084B     		ldr	r3, .L12+24
 311 001c 084A     		ldr	r2, .L12+28
 312 001e 1A60     		str	r2, [r3]	@ float
  83:Src/control.c **** }
 313              		.loc 1 83 0
 314 0020 7047     		bx	lr
 315              	.L13:
 316 0022 00BF     		.align	2
 317              	.L12:
 318 0024 00000000 		.word	accel_T
 319 0028 00000000 		.word	constant_T
 320 002c 00000000 		.word	decrease_T
 321 0030 00000000 		.word	.LANCHOR0
 322 0034 0000A041 		.word	1101004800
 323 0038 00000000 		.word	.LANCHOR1
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 8


 324 003c 00000000 		.word	.LANCHOR2
 325 0040 00002041 		.word	1092616192
 326              		.cfi_endproc
 327              	.LFE162:
 329              		.section	.text.Straight_SysTic_fb,"ax",%progbits
 330              		.align	1
 331              		.global	Straight_SysTic_fb
 332              		.syntax unified
 333              		.thumb
 334              		.thumb_func
 335              		.fpu fpv4-sp-d16
 337              	Straight_SysTic_fb:
 338              	.LFB163:
  84:Src/control.c **** 
  85:Src/control.c **** /****************************************************************************************
  86:Src/control.c ****  * outline  : output pwm for trapezoid accele straight by feadbuck control
  87:Src/control.c ****  * argument : void
  88:Src/control.c ****  * return   : void
  89:Src/control.c **** ********************************************************************************************/
  90:Src/control.c **** void Straight_SysTic_fb(void){
 339              		.loc 1 90 0
 340              		.cfi_startproc
 341              		@ args = 0, pretend = 0, frame = 0
 342              		@ frame_needed = 0, uses_anonymous_args = 0
 343 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 344              	.LCFI5:
 345              		.cfi_def_cfa_offset 24
 346              		.cfi_offset 4, -24
 347              		.cfi_offset 5, -20
 348              		.cfi_offset 6, -16
 349              		.cfi_offset 7, -12
 350              		.cfi_offset 8, -8
 351              		.cfi_offset 14, -4
 352 0004 2DED028B 		vpush.64	{d8}
 353              	.LCFI6:
 354              		.cfi_def_cfa_offset 32
 355              		.cfi_offset 80, -32
 356              		.cfi_offset 81, -28
  91:Src/control.c ****     float encoder_l,encoder_r;
  92:Src/control.c **** 
  93:Src/control.c ****     if(straight_cnt < accel_T){
 357              		.loc 1 93 0
 358 0008 3A4B     		ldr	r3, .L23
 359 000a 1A88     		ldrh	r2, [r3]
 360 000c 3A4B     		ldr	r3, .L23+4
 361 000e 1B88     		ldrh	r3, [r3]
 362 0010 9A42     		cmp	r2, r3
 363 0012 4CD3     		bcc	.L20
  94:Src/control.c ****         encoder_l = enc.velocity_l;
  95:Src/control.c ****         encoder_r = enc.velocity_r;
  96:Src/control.c ****         Calc_Palam(ACCEL,&calc.velocity,&straight_cnt);
  97:Src/control.c ****     }
  98:Src/control.c ****     else if(straight_cnt < constant_T + accel_T){
 364              		.loc 1 98 0
 365 0014 3949     		ldr	r1, .L23+8
 366 0016 0888     		ldrh	r0, [r1]
 367 0018 C118     		adds	r1, r0, r3
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 9


 368 001a 8A42     		cmp	r2, r1
 369 001c 53DB     		blt	.L21
  99:Src/control.c ****         encoder_l = enc.velocity_l;
 100:Src/control.c ****         encoder_r = enc.velocity_r;
 101:Src/control.c ****         Calc_Palam(0,&calc.velocity,&straight_cnt);
 102:Src/control.c ****     }
 103:Src/control.c ****     else if(straight_cnt < decrease_T + constant_T + accel_T){
 370              		.loc 1 103 0
 371 001e 3849     		ldr	r1, .L23+12
 372 0020 0988     		ldrh	r1, [r1]
 373 0022 0144     		add	r1, r1, r0
 374 0024 0B44     		add	r3, r3, r1
 375 0026 9A42     		cmp	r2, r3
 376 0028 58DB     		blt	.L22
 104:Src/control.c ****         encoder_l = enc.velocity_l;
 105:Src/control.c ****         encoder_r = enc.velocity_r;
 106:Src/control.c ****         Calc_Palam(-ACCEL,&calc.velocity,&straight_cnt);
 107:Src/control.c ****     }else{
 108:Src/control.c ****         encoder_l = enc.velocity_c;
 377              		.loc 1 108 0
 378 002a 364B     		ldr	r3, .L23+16
 379 002c 93ED048A 		vldr.32	s16, [r3, #16]
 380              	.LVL28:
 109:Src/control.c ****         encoder_r = enc.velocity_c;
 110:Src/control.c ****         calc.velocity = 0;
 381              		.loc 1 110 0
 382 0030 354B     		ldr	r3, .L23+20
 383 0032 0022     		movs	r2, #0
 384 0034 9A80     		strh	r2, [r3, #4]	@ movhi
 109:Src/control.c ****         encoder_r = enc.velocity_c;
 385              		.loc 1 109 0
 386 0036 F0EE488A 		vmov.f32	s17, s16
 387              	.LVL29:
 388              	.L16:
 111:Src/control.c ****     }
 112:Src/control.c ****     
 113:Src/control.c ****     straight_pid_l = (int16_t)PID_value(calc.velocity,encoder_l,&s_sum_l,&enc.old_l,encoder_Kp,enco
 389              		.loc 1 113 0
 390 003a DFF8CC80 		ldr	r8, .L23+20
 391 003e B8F90430 		ldrsh	r3, [r8, #4]
 392 0042 00EE103A 		vmov	s0, r3	@ int
 393 0046 314F     		ldr	r7, .L23+24
 394 0048 314E     		ldr	r6, .L23+28
 395 004a 324D     		ldr	r5, .L23+32
 396 004c 324C     		ldr	r4, .L23+36
 397 004e 97ED002A 		vldr.32	s4, [r7]
 398 0052 D6ED001A 		vldr.32	s3, [r6]
 399 0056 95ED001A 		vldr.32	s2, [r5]
 400 005a 2146     		mov	r1, r4
 401 005c 2F48     		ldr	r0, .L23+40
 402 005e F0EE480A 		vmov.f32	s1, s16
 403 0062 B8EEC00A 		vcvt.f32.s32	s0, s0
 404 0066 FFF7FEFF 		bl	PID_value
 405              	.LVL30:
 406 006a BDEEC00A 		vcvt.s32.f32	s0, s0
 407 006e 2C4B     		ldr	r3, .L23+44
 408 0070 10EE102A 		vmov	r2, s0	@ int
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 10


 409 0074 1A80     		strh	r2, [r3]	@ movhi
 114:Src/control.c ****     straight_pid_r = (int16_t)PID_value(calc.velocity,encoder_r,&s_sum_r,&enc.old_r,encoder_Kp,enco
 410              		.loc 1 114 0
 411 0076 B8F90430 		ldrsh	r3, [r8, #4]
 412 007a 00EE103A 		vmov	s0, r3	@ int
 413 007e 97ED002A 		vldr.32	s4, [r7]
 414 0082 D6ED001A 		vldr.32	s3, [r6]
 415 0086 95ED001A 		vldr.32	s2, [r5]
 416 008a 211D     		adds	r1, r4, #4
 417 008c 2548     		ldr	r0, .L23+48
 418 008e F0EE680A 		vmov.f32	s1, s17
 419 0092 B8EEC00A 		vcvt.f32.s32	s0, s0
 420 0096 FFF7FEFF 		bl	PID_value
 421              	.LVL31:
 422 009a BDEEC00A 		vcvt.s32.f32	s0, s0
 423 009e 224B     		ldr	r3, .L23+52
 424 00a0 10EE102A 		vmov	r2, s0	@ int
 425 00a4 1A80     		strh	r2, [r3]	@ movhi
 115:Src/control.c **** }
 426              		.loc 1 115 0
 427 00a6 BDEC028B 		vldm	sp!, {d8}
 428              	.LCFI7:
 429              		.cfi_remember_state
 430              		.cfi_restore 80
 431              		.cfi_restore 81
 432              		.cfi_def_cfa_offset 24
 433              	.LVL32:
 434 00aa BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 435              	.LVL33:
 436              	.L20:
 437              	.LCFI8:
 438              		.cfi_restore_state
  94:Src/control.c ****         encoder_r = enc.velocity_r;
 439              		.loc 1 94 0
 440 00ae 154B     		ldr	r3, .L23+16
 441 00b0 93ED028A 		vldr.32	s16, [r3, #8]
 442              	.LVL34:
  95:Src/control.c ****         Calc_Palam(ACCEL,&calc.velocity,&straight_cnt);
 443              		.loc 1 95 0
 444 00b4 D3ED038A 		vldr.32	s17, [r3, #12]
 445              	.LVL35:
  96:Src/control.c ****     }
 446              		.loc 1 96 0
 447 00b8 0E4A     		ldr	r2, .L23
 448 00ba 1C49     		ldr	r1, .L23+56
 449 00bc 4FF47A60 		mov	r0, #4000
 450 00c0 FFF7FEFF 		bl	Calc_Palam
 451              	.LVL36:
 452 00c4 B9E7     		b	.L16
 453              	.LVL37:
 454              	.L21:
  99:Src/control.c ****         encoder_r = enc.velocity_r;
 455              		.loc 1 99 0
 456 00c6 0F4B     		ldr	r3, .L23+16
 457 00c8 93ED028A 		vldr.32	s16, [r3, #8]
 458              	.LVL38:
 100:Src/control.c ****         Calc_Palam(0,&calc.velocity,&straight_cnt);
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 11


 459              		.loc 1 100 0
 460 00cc D3ED038A 		vldr.32	s17, [r3, #12]
 461              	.LVL39:
 101:Src/control.c ****     }
 462              		.loc 1 101 0
 463 00d0 084A     		ldr	r2, .L23
 464 00d2 1649     		ldr	r1, .L23+56
 465 00d4 0020     		movs	r0, #0
 466 00d6 FFF7FEFF 		bl	Calc_Palam
 467              	.LVL40:
 468 00da AEE7     		b	.L16
 469              	.LVL41:
 470              	.L22:
 104:Src/control.c ****         encoder_r = enc.velocity_r;
 471              		.loc 1 104 0
 472 00dc 094B     		ldr	r3, .L23+16
 473 00de 93ED028A 		vldr.32	s16, [r3, #8]
 474              	.LVL42:
 105:Src/control.c ****         Calc_Palam(-ACCEL,&calc.velocity,&straight_cnt);
 475              		.loc 1 105 0
 476 00e2 D3ED038A 		vldr.32	s17, [r3, #12]
 477              	.LVL43:
 106:Src/control.c ****     }else{
 478              		.loc 1 106 0
 479 00e6 034A     		ldr	r2, .L23
 480 00e8 1049     		ldr	r1, .L23+56
 481 00ea 1148     		ldr	r0, .L23+60
 482 00ec FFF7FEFF 		bl	Calc_Palam
 483              	.LVL44:
 484 00f0 A3E7     		b	.L16
 485              	.L24:
 486 00f2 00BF     		.align	2
 487              	.L23:
 488 00f4 00000000 		.word	straight_cnt
 489 00f8 00000000 		.word	accel_T
 490 00fc 00000000 		.word	constant_T
 491 0100 00000000 		.word	decrease_T
 492 0104 00000000 		.word	enc
 493 0108 00000000 		.word	calc
 494 010c 00000000 		.word	.LANCHOR2
 495 0110 00000000 		.word	.LANCHOR1
 496 0114 00000000 		.word	.LANCHOR0
 497 0118 1C000000 		.word	enc+28
 498 011c 00000000 		.word	s_sum_l
 499 0120 00000000 		.word	straight_pid_l
 500 0124 00000000 		.word	s_sum_r
 501 0128 00000000 		.word	straight_pid_r
 502 012c 04000000 		.word	calc+4
 503 0130 60F0FFFF 		.word	-4000
 504              		.cfi_endproc
 505              	.LFE163:
 507              		.section	.text.Yawrate_Calc_fb,"ax",%progbits
 508              		.align	1
 509              		.global	Yawrate_Calc_fb
 510              		.syntax unified
 511              		.thumb
 512              		.thumb_func
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 12


 513              		.fpu fpv4-sp-d16
 515              	Yawrate_Calc_fb:
 516              	.LFB164:
 116:Src/control.c **** 
 117:Src/control.c **** 
 118:Src/control.c **** /****************************************************************************************
 119:Src/control.c ****  * outline  : calcurate trapezoid accel
 120:Src/control.c ****  * argument : degree[degree],v_start[degree/s],v_end[degree/s]
 121:Src/control.c ****  * return   : void
 122:Src/control.c **** ********************************************************************************************/
 123:Src/control.c **** void Yawrate_Calc_fb(int16_t degree,int16_t v_start,int16_t v_end){
 517              		.loc 1 123 0
 518              		.cfi_startproc
 519              		@ args = 0, pretend = 0, frame = 0
 520              		@ frame_needed = 0, uses_anonymous_args = 0
 521              	.LVL45:
 522 0000 30B5     		push	{r4, r5, lr}
 523              	.LCFI9:
 524              		.cfi_def_cfa_offset 12
 525              		.cfi_offset 4, -12
 526              		.cfi_offset 5, -8
 527              		.cfi_offset 14, -4
 528 0002 2DED048B 		vpush.64	{d8, d9}
 529              	.LCFI10:
 530              		.cfi_def_cfa_offset 28
 531              		.cfi_offset 80, -28
 532              		.cfi_offset 81, -24
 533              		.cfi_offset 82, -20
 534              		.cfi_offset 83, -16
 535 0006 85B0     		sub	sp, sp, #20
 536              	.LCFI11:
 537              		.cfi_def_cfa_offset 48
 124:Src/control.c ****     calc.yawrate_velocity = v_start;
 538              		.loc 1 124 0
 539 0008 354B     		ldr	r3, .L27
 540 000a 9981     		strh	r1, [r3, #12]	@ movhi
 541              	.LVL46:
 125:Src/control.c **** 
 126:Src/control.c ****     float t1=0,t2=0,t3=0;
 127:Src/control.c ****     float constant_L;
 128:Src/control.c **** 
 129:Src/control.c ****     t1 = (float)(Y_MAX_VELOCITY - v_start) / Y_ACCEL;
 542              		.loc 1 129 0
 543 000c C1F59673 		rsb	r3, r1, #300
 544 0010 07EE903A 		vmov	s15, r3	@ int
 545 0014 F8EEE77A 		vcvt.f32.s32	s15, s15
 546 0018 9FED327A 		vldr.32	s14, .L27+4
 547 001c C7EE878A 		vdiv.f32	s17, s15, s14
 548              	.LVL47:
 130:Src/control.c ****     t3 = (float)(Y_MAX_VELOCITY - v_end) / Y_ACCEL;
 549              		.loc 1 130 0
 550 0020 C2F59673 		rsb	r3, r2, #300
 551 0024 07EE903A 		vmov	s15, r3	@ int
 552 0028 F8EEE77A 		vcvt.f32.s32	s15, s15
 553 002c 87EE878A 		vdiv.f32	s16, s15, s14
 554              	.LVL48:
 131:Src/control.c **** 
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 13


 132:Src/control.c ****     constant_L = (float)degree - (Y_MAX_VELOCITY + v_start) * t1 / 2 - (Y_MAX_VELOCITY + v_end) * t
 555              		.loc 1 132 0
 556 0030 07EE900A 		vmov	s15, r0	@ int
 557 0034 B8EEE77A 		vcvt.f32.s32	s14, s15
 558 0038 01F59673 		add	r3, r1, #300
 559 003c 07EE903A 		vmov	s15, r3	@ int
 560 0040 F8EEE77A 		vcvt.f32.s32	s15, s15
 561 0044 67EEA87A 		vmul.f32	s15, s15, s17
 562 0048 F6EE006A 		vmov.f32	s13, #5.0e-1
 563 004c 67EEA67A 		vmul.f32	s15, s15, s13
 564 0050 77EE677A 		vsub.f32	s15, s14, s15
 565 0054 02F59673 		add	r3, r2, #300
 566 0058 07EE103A 		vmov	s14, r3	@ int
 567 005c B8EEC77A 		vcvt.f32.s32	s14, s14
 568 0060 27EE087A 		vmul.f32	s14, s14, s16
 569 0064 27EE267A 		vmul.f32	s14, s14, s13
 570 0068 37EEC77A 		vsub.f32	s14, s15, s14
 571              	.LVL49:
 133:Src/control.c ****     
 134:Src/control.c ****     t2 = constant_L / Y_MAX_VELOCITY;
 572              		.loc 1 134 0
 573 006c DFED1E7A 		vldr.32	s15, .L27+8
 574 0070 87EE279A 		vdiv.f32	s18, s14, s15
 575              	.LVL50:
 135:Src/control.c ****     printf("\nt1:%f,t2:%f,t3%f\r\n",t1,t2,t3);
 576              		.loc 1 135 0
 577 0074 18EE900A 		vmov	r0, s17
 578              	.LVL51:
 579 0078 FFF7FEFF 		bl	__aeabi_f2d
 580              	.LVL52:
 581 007c 0446     		mov	r4, r0
 582 007e 0D46     		mov	r5, r1
 583 0080 18EE100A 		vmov	r0, s16
 584 0084 FFF7FEFF 		bl	__aeabi_f2d
 585              	.LVL53:
 586 0088 CDE90201 		strd	r0, [sp, #8]
 587 008c 19EE100A 		vmov	r0, s18
 588 0090 FFF7FEFF 		bl	__aeabi_f2d
 589              	.LVL54:
 590 0094 CDE90001 		strd	r0, [sp]
 591 0098 2246     		mov	r2, r4
 592 009a 2B46     		mov	r3, r5
 593 009c 1348     		ldr	r0, .L27+12
 594 009e FFF7FEFF 		bl	printf
 595              	.LVL55:
 136:Src/control.c **** 
 137:Src/control.c ****     t1 *= 1000;
 596              		.loc 1 137 0
 597 00a2 DFED137A 		vldr.32	s15, .L27+16
 598 00a6 68EEA78A 		vmul.f32	s17, s17, s15
 599              	.LVL56:
 138:Src/control.c ****     t2 *= 1000;
 600              		.loc 1 138 0
 601 00aa 29EE279A 		vmul.f32	s18, s18, s15
 602              	.LVL57:
 139:Src/control.c ****     t3 *= 1000;
 603              		.loc 1 139 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 14


 604 00ae 28EE278A 		vmul.f32	s16, s16, s15
 605              	.LVL58:
 140:Src/control.c **** 
 141:Src/control.c ****     y_accel_T = t1;
 606              		.loc 1 141 0
 607 00b2 FCEEE88A 		vcvt.u32.f32	s17, s17
 608              	.LVL59:
 609 00b6 0F4B     		ldr	r3, .L27+20
 610 00b8 18EE902A 		vmov	r2, s17	@ int
 611 00bc 1A80     		strh	r2, [r3]	@ movhi
 142:Src/control.c ****     y_constant_T = t2;
 612              		.loc 1 142 0
 613 00be BCEEC99A 		vcvt.u32.f32	s18, s18
 614              	.LVL60:
 615 00c2 0D4B     		ldr	r3, .L27+24
 616 00c4 19EE102A 		vmov	r2, s18	@ int
 617 00c8 1A80     		strh	r2, [r3]	@ movhi
 143:Src/control.c ****     y_decrease_T = t3;
 618              		.loc 1 143 0
 619 00ca BCEEC88A 		vcvt.u32.f32	s16, s16
 620              	.LVL61:
 621 00ce 0B4B     		ldr	r3, .L27+28
 622 00d0 18EE102A 		vmov	r2, s16	@ int
 623 00d4 1A80     		strh	r2, [r3]	@ movhi
 144:Src/control.c **** }
 624              		.loc 1 144 0
 625 00d6 05B0     		add	sp, sp, #20
 626              	.LCFI12:
 627              		.cfi_def_cfa_offset 28
 628              		@ sp needed
 629 00d8 BDEC048B 		vldm	sp!, {d8-d9}
 630              	.LCFI13:
 631              		.cfi_restore 82
 632              		.cfi_restore 83
 633              		.cfi_restore 80
 634              		.cfi_restore 81
 635              		.cfi_def_cfa_offset 12
 636 00dc 30BD     		pop	{r4, r5, pc}
 637              	.L28:
 638 00de 00BF     		.align	2
 639              	.L27:
 640 00e0 00000000 		.word	calc
 641 00e4 0000FA44 		.word	1157234688
 642 00e8 00009643 		.word	1133903872
 643 00ec 00000000 		.word	.LC0
 644 00f0 00007A44 		.word	1148846080
 645 00f4 00000000 		.word	y_accel_T
 646 00f8 00000000 		.word	y_constant_T
 647 00fc 00000000 		.word	y_decrease_T
 648              		.cfi_endproc
 649              	.LFE164:
 651              		.section	.text.Yawrate_Calc_Zero,"ax",%progbits
 652              		.align	1
 653              		.global	Yawrate_Calc_Zero
 654              		.syntax unified
 655              		.thumb
 656              		.thumb_func
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 15


 657              		.fpu fpv4-sp-d16
 659              	Yawrate_Calc_Zero:
 660              	.LFB165:
 145:Src/control.c **** 
 146:Src/control.c **** void Yawrate_Calc_Zero(void){
 661              		.loc 1 146 0
 662              		.cfi_startproc
 663              		@ args = 0, pretend = 0, frame = 0
 664              		@ frame_needed = 0, uses_anonymous_args = 0
 665              		@ link register save eliminated.
 147:Src/control.c ****     y_accel_T = 0;
 666              		.loc 1 147 0
 667 0000 0023     		movs	r3, #0
 668 0002 034A     		ldr	r2, .L30
 669 0004 1380     		strh	r3, [r2]	@ movhi
 148:Src/control.c ****     y_constant_T = 0;
 670              		.loc 1 148 0
 671 0006 034A     		ldr	r2, .L30+4
 672 0008 1380     		strh	r3, [r2]	@ movhi
 149:Src/control.c ****     y_decrease_T = 0;
 673              		.loc 1 149 0
 674 000a 034A     		ldr	r2, .L30+8
 675 000c 1380     		strh	r3, [r2]	@ movhi
 150:Src/control.c **** }
 676              		.loc 1 150 0
 677 000e 7047     		bx	lr
 678              	.L31:
 679              		.align	2
 680              	.L30:
 681 0010 00000000 		.word	y_accel_T
 682 0014 00000000 		.word	y_constant_T
 683 0018 00000000 		.word	y_decrease_T
 684              		.cfi_endproc
 685              	.LFE165:
 687              		.section	.text.Yawrate_SysTic_fb,"ax",%progbits
 688              		.align	1
 689              		.global	Yawrate_SysTic_fb
 690              		.syntax unified
 691              		.thumb
 692              		.thumb_func
 693              		.fpu fpv4-sp-d16
 695              	Yawrate_SysTic_fb:
 696              	.LFB166:
 151:Src/control.c **** 
 152:Src/control.c **** /****************************************************************************************
 153:Src/control.c ****  * outline  : call 1ms (roll by feadbuck control)
 154:Src/control.c ****  * argument : void
 155:Src/control.c ****  * return   : void
 156:Src/control.c **** ********************************************************************************************/
 157:Src/control.c **** void Yawrate_SysTic_fb(void){
 697              		.loc 1 157 0
 698              		.cfi_startproc
 699              		@ args = 0, pretend = 0, frame = 0
 700              		@ frame_needed = 0, uses_anonymous_args = 0
 701 0000 08B5     		push	{r3, lr}
 702              	.LCFI14:
 703              		.cfi_def_cfa_offset 8
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 16


 704              		.cfi_offset 3, -8
 705              		.cfi_offset 14, -4
 158:Src/control.c ****     if(yawrate_cnt < y_accel_T){
 706              		.loc 1 158 0
 707 0002 214B     		ldr	r3, .L41
 708 0004 1A88     		ldrh	r2, [r3]
 709 0006 214B     		ldr	r3, .L41+4
 710 0008 1B88     		ldrh	r3, [r3]
 711 000a 9A42     		cmp	r2, r3
 712 000c 28D3     		bcc	.L38
 159:Src/control.c ****         Calc_Palam(Y_ACCEL,&calc.yawrate_velocity,&yawrate_cnt);
 160:Src/control.c ****     }else if(yawrate_cnt < y_constant_T + y_accel_T){
 713              		.loc 1 160 0
 714 000e 2049     		ldr	r1, .L41+8
 715 0010 0888     		ldrh	r0, [r1]
 716 0012 C118     		adds	r1, r0, r3
 717 0014 8A42     		cmp	r2, r1
 718 0016 2ADB     		blt	.L39
 161:Src/control.c ****         Calc_Palam(0,&calc.yawrate_velocity,&yawrate_cnt);
 162:Src/control.c ****     }else if(yawrate_cnt < y_decrease_T + y_constant_T + y_accel_T){
 719              		.loc 1 162 0
 720 0018 1E49     		ldr	r1, .L41+12
 721 001a 0988     		ldrh	r1, [r1]
 722 001c 0144     		add	r1, r1, r0
 723 001e 0B44     		add	r3, r3, r1
 724 0020 9A42     		cmp	r2, r3
 725 0022 2ADB     		blt	.L40
 163:Src/control.c ****         Calc_Palam(-Y_ACCEL,&calc.yawrate_velocity,&yawrate_cnt);
 164:Src/control.c ****     }else{
 165:Src/control.c ****         calc.yawrate_velocity = 0;
 726              		.loc 1 165 0
 727 0024 1C4B     		ldr	r3, .L41+16
 728 0026 0022     		movs	r2, #0
 729 0028 9A81     		strh	r2, [r3, #12]	@ movhi
 730              	.L34:
 166:Src/control.c ****     }
 167:Src/control.c ****     yawrate_pid = (int16_t)PID_value((float)calc.yawrate_velocity,gyro.velocity,&gyro.degree,&gyro.
 731              		.loc 1 167 0
 732 002a 1B4B     		ldr	r3, .L41+16
 733 002c B3F90C30 		ldrsh	r3, [r3, #12]
 734 0030 00EE103A 		vmov	s0, r3	@ int
 735 0034 194B     		ldr	r3, .L41+20
 736 0036 B3EE0E2A 		vmov.f32	s4, #3.0e+1
 737 003a F7EE001A 		vmov.f32	s3, #1.0e+0
 738 003e B2EE0A1A 		vmov.f32	s2, #1.3e+1
 739 0042 1946     		mov	r1, r3
 740 0044 181D     		adds	r0, r3, #4
 741 0046 D3ED020A 		vldr.32	s1, [r3, #8]
 742 004a B8EEC00A 		vcvt.f32.s32	s0, s0
 743 004e FFF7FEFF 		bl	PID_value
 744              	.LVL62:
 745 0052 BDEEC00A 		vcvt.s32.f32	s0, s0
 746 0056 124B     		ldr	r3, .L41+24
 747 0058 10EE102A 		vmov	r2, s0	@ int
 748 005c 1A80     		strh	r2, [r3]	@ movhi
 168:Src/control.c **** }
 749              		.loc 1 168 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 17


 750 005e 08BD     		pop	{r3, pc}
 751              	.L38:
 159:Src/control.c ****     }else if(yawrate_cnt < y_constant_T + y_accel_T){
 752              		.loc 1 159 0
 753 0060 094A     		ldr	r2, .L41
 754 0062 1049     		ldr	r1, .L41+28
 755 0064 4FF4FA60 		mov	r0, #2000
 756 0068 FFF7FEFF 		bl	Calc_Palam
 757              	.LVL63:
 758 006c DDE7     		b	.L34
 759              	.L39:
 161:Src/control.c ****     }else if(yawrate_cnt < y_decrease_T + y_constant_T + y_accel_T){
 760              		.loc 1 161 0
 761 006e 064A     		ldr	r2, .L41
 762 0070 0C49     		ldr	r1, .L41+28
 763 0072 0020     		movs	r0, #0
 764 0074 FFF7FEFF 		bl	Calc_Palam
 765              	.LVL64:
 766 0078 D7E7     		b	.L34
 767              	.L40:
 163:Src/control.c ****     }else{
 768              		.loc 1 163 0
 769 007a 034A     		ldr	r2, .L41
 770 007c 0949     		ldr	r1, .L41+28
 771 007e 0A48     		ldr	r0, .L41+32
 772 0080 FFF7FEFF 		bl	Calc_Palam
 773              	.LVL65:
 774 0084 D1E7     		b	.L34
 775              	.L42:
 776 0086 00BF     		.align	2
 777              	.L41:
 778 0088 00000000 		.word	yawrate_cnt
 779 008c 00000000 		.word	y_accel_T
 780 0090 00000000 		.word	y_constant_T
 781 0094 00000000 		.word	y_decrease_T
 782 0098 00000000 		.word	calc
 783 009c 08000000 		.word	gyro+8
 784 00a0 00000000 		.word	yawrate_pid
 785 00a4 0C000000 		.word	calc+12
 786 00a8 30F8FFFF 		.word	-2000
 787              		.cfi_endproc
 788              	.LFE166:
 790              		.section	.text.Control_pwm,"ax",%progbits
 791              		.align	1
 792              		.global	Control_pwm
 793              		.syntax unified
 794              		.thumb
 795              		.thumb_func
 796              		.fpu fpv4-sp-d16
 798              	Control_pwm:
 799              	.LFB167:
 169:Src/control.c **** 
 170:Src/control.c **** void Control_pwm(void){
 800              		.loc 1 170 0
 801              		.cfi_startproc
 802              		@ args = 0, pretend = 0, frame = 0
 803              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 18


 804 0000 08B5     		push	{r3, lr}
 805              	.LCFI15:
 806              		.cfi_def_cfa_offset 8
 807              		.cfi_offset 3, -8
 808              		.cfi_offset 14, -4
 809              	.LVL66:
 171:Src/control.c ****     int16_t pwm_l=0,pwm_r=0;
 172:Src/control.c **** 
 173:Src/control.c ****     if(flag.straight==ON){
 810              		.loc 1 173 0
 811 0002 0E4B     		ldr	r3, .L50
 812 0004 B3F90230 		ldrsh	r3, [r3, #2]
 813 0008 012B     		cmp	r3, #1
 814 000a 09D0     		beq	.L48
 171:Src/control.c ****     int16_t pwm_l=0,pwm_r=0;
 815              		.loc 1 171 0
 816 000c 0021     		movs	r1, #0
 817 000e 0846     		mov	r0, r1
 818              	.LVL67:
 819              	.L44:
 174:Src/control.c ****         pwm_l += straight_pid_l;
 175:Src/control.c ****         pwm_r += straight_pid_r;
 176:Src/control.c ****     }
 177:Src/control.c ****     if(flag.yawrate==ON){
 820              		.loc 1 177 0
 821 0010 0A4B     		ldr	r3, .L50
 822 0012 B3F90430 		ldrsh	r3, [r3, #4]
 823 0016 012B     		cmp	r3, #1
 824 0018 09D0     		beq	.L49
 825              	.L45:
 178:Src/control.c ****         pwm_l -= yawrate_pid;
 179:Src/control.c ****         pwm_r += yawrate_pid;
 180:Src/control.c ****     }
 181:Src/control.c ****     Motor_pwm(pwm_l,pwm_r);
 826              		.loc 1 181 0
 827 001a FFF7FEFF 		bl	Motor_pwm
 828              	.LVL68:
 182:Src/control.c **** }
 829              		.loc 1 182 0
 830 001e 08BD     		pop	{r3, pc}
 831              	.LVL69:
 832              	.L48:
 174:Src/control.c ****         pwm_l += straight_pid_l;
 833              		.loc 1 174 0
 834 0020 074B     		ldr	r3, .L50+4
 835 0022 B3F90000 		ldrsh	r0, [r3]
 836              	.LVL70:
 175:Src/control.c ****     }
 837              		.loc 1 175 0
 838 0026 074B     		ldr	r3, .L50+8
 839 0028 B3F90010 		ldrsh	r1, [r3]
 840              	.LVL71:
 841 002c F0E7     		b	.L44
 842              	.L49:
 178:Src/control.c ****         pwm_l -= yawrate_pid;
 843              		.loc 1 178 0
 844 002e 064B     		ldr	r3, .L50+12
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 19


 845 0030 1B88     		ldrh	r3, [r3]
 846 0032 C01A     		subs	r0, r0, r3
 847              	.LVL72:
 848 0034 00B2     		sxth	r0, r0
 849              	.LVL73:
 179:Src/control.c ****     }
 850              		.loc 1 179 0
 851 0036 1944     		add	r1, r1, r3
 852              	.LVL74:
 853 0038 09B2     		sxth	r1, r1
 854              	.LVL75:
 855 003a EEE7     		b	.L45
 856              	.L51:
 857              		.align	2
 858              	.L50:
 859 003c 00000000 		.word	flag
 860 0040 00000000 		.word	straight_pid_l
 861 0044 00000000 		.word	straight_pid_r
 862 0048 00000000 		.word	yawrate_pid
 863              		.cfi_endproc
 864              	.LFE167:
 866              		.section	.text.Output_Buzzer,"ax",%progbits
 867              		.align	1
 868              		.global	Output_Buzzer
 869              		.syntax unified
 870              		.thumb
 871              		.thumb_func
 872              		.fpu fpv4-sp-d16
 874              	Output_Buzzer:
 875              	.LFB168:
 183:Src/control.c **** /****************************************************************************************
 184:Src/control.c ****  * outline  : turn on buzzer 0.3sec
 185:Src/control.c ****  * argument : Hz
 186:Src/control.c ****  * return   : void
 187:Src/control.c **** ********************************************************************************************/
 188:Src/control.c **** void Output_Buzzer(uint8_t Hz){
 876              		.loc 1 188 0
 877              		.cfi_startproc
 878              		@ args = 0, pretend = 0, frame = 0
 879              		@ frame_needed = 0, uses_anonymous_args = 0
 880              	.LVL76:
 881 0000 08B5     		push	{r3, lr}
 882              	.LCFI16:
 883              		.cfi_def_cfa_offset 8
 884              		.cfi_offset 3, -8
 885              		.cfi_offset 14, -4
 189:Src/control.c ****     Buzzer_pwm(Hz,300);
 886              		.loc 1 189 0
 887 0002 4FF49671 		mov	r1, #300
 888 0006 FFF7FEFF 		bl	Buzzer_pwm
 889              	.LVL77:
 190:Src/control.c ****     HAL_Delay(300);
 890              		.loc 1 190 0
 891 000a 4FF49670 		mov	r0, #300
 892 000e FFF7FEFF 		bl	HAL_Delay
 893              	.LVL78:
 191:Src/control.c ****     Buzzer_pwm(HZ_NORMAL,0);
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 20


 894              		.loc 1 191 0
 895 0012 0021     		movs	r1, #0
 896 0014 0A20     		movs	r0, #10
 897 0016 FFF7FEFF 		bl	Buzzer_pwm
 898              	.LVL79:
 192:Src/control.c **** }
 899              		.loc 1 192 0
 900 001a 08BD     		pop	{r3, pc}
 901              		.cfi_endproc
 902              	.LFE168:
 904              		.section	.text.Sensor_Check,"ax",%progbits
 905              		.align	1
 906              		.global	Sensor_Check
 907              		.syntax unified
 908              		.thumb
 909              		.thumb_func
 910              		.fpu fpv4-sp-d16
 912              	Sensor_Check:
 913              	.LFB169:
 193:Src/control.c **** 
 194:Src/control.c **** 
 195:Src/control.c **** /****************************************************************************************
 196:Src/control.c ****  * outline  : sensor check
 197:Src/control.c ****  * argument : void
 198:Src/control.c ****  * return   : void
 199:Src/control.c **** ********************************************************************************************/
 200:Src/control.c **** void Sensor_Check(void){
 914              		.loc 1 200 0
 915              		.cfi_startproc
 916              		@ args = 0, pretend = 0, frame = 0
 917              		@ frame_needed = 0, uses_anonymous_args = 0
 918 0000 08B5     		push	{r3, lr}
 919              	.LCFI17:
 920              		.cfi_def_cfa_offset 8
 921              		.cfi_offset 3, -8
 922              		.cfi_offset 14, -4
 201:Src/control.c ****     if(sensor.wall[0]==true){
 923              		.loc 1 201 0
 924 0002 214B     		ldr	r3, .L68
 925 0004 1B7E     		ldrb	r3, [r3, #24]	@ zero_extendqisi2
 926 0006 012B     		cmp	r3, #1
 927 0008 23D0     		beq	.L64
 202:Src/control.c ****         HAL_GPIO_WritePin(led0_GPIO_Port,led0_Pin,GPIO_PIN_RESET);
 203:Src/control.c ****     }else{
 204:Src/control.c ****         HAL_GPIO_WritePin(led0_GPIO_Port,led0_Pin,GPIO_PIN_SET);
 928              		.loc 1 204 0
 929 000a 0122     		movs	r2, #1
 930 000c 4FF40051 		mov	r1, #8192
 931 0010 1E48     		ldr	r0, .L68+4
 932 0012 FFF7FEFF 		bl	HAL_GPIO_WritePin
 933              	.LVL80:
 934              	.L56:
 205:Src/control.c ****     }
 206:Src/control.c ****     if(sensor.wall[1]==true){
 935              		.loc 1 206 0
 936 0016 1C4B     		ldr	r3, .L68
 937 0018 5B7E     		ldrb	r3, [r3, #25]	@ zero_extendqisi2
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 21


 938 001a 012B     		cmp	r3, #1
 939 001c 20D0     		beq	.L65
 207:Src/control.c ****         HAL_GPIO_WritePin(led3_GPIO_Port,led3_Pin,GPIO_PIN_RESET);
 208:Src/control.c ****     }else{
 209:Src/control.c ****         HAL_GPIO_WritePin(led3_GPIO_Port,led3_Pin,GPIO_PIN_SET);
 940              		.loc 1 209 0
 941 001e 0122     		movs	r2, #1
 942 0020 4FF48071 		mov	r1, #256
 943 0024 1948     		ldr	r0, .L68+4
 944 0026 FFF7FEFF 		bl	HAL_GPIO_WritePin
 945              	.LVL81:
 946              	.L58:
 210:Src/control.c ****     }
 211:Src/control.c ****     if(sensor.wall[2]==true){
 947              		.loc 1 211 0
 948 002a 174B     		ldr	r3, .L68
 949 002c 9B7E     		ldrb	r3, [r3, #26]	@ zero_extendqisi2
 950 002e 012B     		cmp	r3, #1
 951 0030 1DD0     		beq	.L66
 212:Src/control.c ****         HAL_GPIO_WritePin(led2_GPIO_Port,led2_Pin,GPIO_PIN_RESET);
 213:Src/control.c ****     }else{
 214:Src/control.c ****         HAL_GPIO_WritePin(led2_GPIO_Port,led2_Pin,GPIO_PIN_SET);
 952              		.loc 1 214 0
 953 0032 0122     		movs	r2, #1
 954 0034 8021     		movs	r1, #128
 955 0036 1548     		ldr	r0, .L68+4
 956 0038 FFF7FEFF 		bl	HAL_GPIO_WritePin
 957              	.LVL82:
 958              	.L60:
 215:Src/control.c ****     }
 216:Src/control.c ****     if(sensor.wall[3]==true){
 959              		.loc 1 216 0
 960 003c 124B     		ldr	r3, .L68
 961 003e DB7E     		ldrb	r3, [r3, #27]	@ zero_extendqisi2
 962 0040 012B     		cmp	r3, #1
 963 0042 1AD0     		beq	.L67
 217:Src/control.c ****         HAL_GPIO_WritePin(led1_GPIO_Port,led1_Pin,GPIO_PIN_RESET);
 218:Src/control.c ****     }else{
 219:Src/control.c ****         HAL_GPIO_WritePin(led1_GPIO_Port,led1_Pin,GPIO_PIN_SET);
 964              		.loc 1 219 0
 965 0044 0122     		movs	r2, #1
 966 0046 4FF48041 		mov	r1, #16384
 967 004a 1048     		ldr	r0, .L68+4
 968 004c FFF7FEFF 		bl	HAL_GPIO_WritePin
 969              	.LVL83:
 970              	.L54:
 220:Src/control.c ****     } 
 221:Src/control.c **** }
 971              		.loc 1 221 0
 972 0050 08BD     		pop	{r3, pc}
 973              	.L64:
 202:Src/control.c ****     }else{
 974              		.loc 1 202 0
 975 0052 0022     		movs	r2, #0
 976 0054 4FF40051 		mov	r1, #8192
 977 0058 0C48     		ldr	r0, .L68+4
 978 005a FFF7FEFF 		bl	HAL_GPIO_WritePin
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 22


 979              	.LVL84:
 980 005e DAE7     		b	.L56
 981              	.L65:
 207:Src/control.c ****     }else{
 982              		.loc 1 207 0
 983 0060 0022     		movs	r2, #0
 984 0062 4FF48071 		mov	r1, #256
 985 0066 0948     		ldr	r0, .L68+4
 986 0068 FFF7FEFF 		bl	HAL_GPIO_WritePin
 987              	.LVL85:
 988 006c DDE7     		b	.L58
 989              	.L66:
 212:Src/control.c ****     }else{
 990              		.loc 1 212 0
 991 006e 0022     		movs	r2, #0
 992 0070 8021     		movs	r1, #128
 993 0072 0648     		ldr	r0, .L68+4
 994 0074 FFF7FEFF 		bl	HAL_GPIO_WritePin
 995              	.LVL86:
 996 0078 E0E7     		b	.L60
 997              	.L67:
 217:Src/control.c ****     }else{
 998              		.loc 1 217 0
 999 007a 0022     		movs	r2, #0
 1000 007c 4FF48041 		mov	r1, #16384
 1001 0080 0248     		ldr	r0, .L68+4
 1002 0082 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1003              	.LVL87:
 1004 0086 E3E7     		b	.L54
 1005              	.L69:
 1006              		.align	2
 1007              	.L68:
 1008 0088 00000000 		.word	sensor
 1009 008c 00080240 		.word	1073874944
 1010              		.cfi_endproc
 1011              	.LFE169:
 1013              		.global	encoder_Kd
 1014              		.global	encoder_Ki
 1015              		.global	encoder_Kp
 1016              		.comm	yawrate_pid,2,2
 1017              		.comm	straight_pid_r,2,2
 1018              		.comm	straight_pid_l,2,2
 1019              		.comm	y_sum,4,4
 1020              		.comm	s_sum_r,4,4
 1021              		.comm	s_sum_l,4,4
 1022              		.section	.bss.encoder_Kd,"aw",%nobits
 1023              		.align	2
 1024              		.set	.LANCHOR2,. + 0
 1027              	encoder_Kd:
 1028 0000 00000000 		.space	4
 1029              		.section	.bss.encoder_Ki,"aw",%nobits
 1030              		.align	2
 1031              		.set	.LANCHOR1,. + 0
 1034              	encoder_Ki:
 1035 0000 00000000 		.space	4
 1036              		.section	.bss.encoder_Kp,"aw",%nobits
 1037              		.align	2
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 23


 1038              		.set	.LANCHOR0,. + 0
 1041              	encoder_Kp:
 1042 0000 00000000 		.space	4
 1043              		.section	.rodata.Straight_Calc_fb.str1.4,"aMS",%progbits,1
 1044              		.align	2
 1045              	.LC0:
 1046 0000 0A74313A 		.ascii	"\012t1:%f,t2:%f,t3%f\015\012\000"
 1046      25662C74 
 1046      323A2566 
 1046      2C743325 
 1046      660D0A00 
 1047              		.text
 1048              	.Letext0:
 1049              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1050              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1051              		.file 4 "Inc/control.h"
 1052              		.file 5 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1053              		.file 6 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1054              		.file 7 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\lib\\gcc\\arm-none-eabi
 1055              		.file 8 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1056              		.file 9 "Inc/global.h"
 1057              		.file 10 "Drivers/CMSIS/Include/core_cm4.h"
 1058              		.file 11 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 1059              		.file 12 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f405xx.h"
 1060              		.file 13 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 1061              		.file 14 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 1062              		.file 15 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 1063              		.file 16 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 1064              		.file 17 "Inc/tim.h"
 1065              		.file 18 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
 1066              		.file 19 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 1067              		.file 20 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 24


DEFINED SYMBOLS
                            *ABS*:00000000 control.c
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:18     .text.PID_value:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:25     .text.PID_value:00000000 PID_value
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:70     .text.PID_value:00000040 $d
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:76     .text.Calc_Palam:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:83     .text.Calc_Palam:00000000 Calc_Palam
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:112    .text.Calc_Palam:00000034 $d
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:118    .text.Straight_Calc_fb:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:125    .text.Straight_Calc_fb:00000000 Straight_Calc_fb
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:260    .text.Straight_Calc_fb:000000e4 $d
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:277    .text.Straight_Calc_Zero:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:284    .text.Straight_Calc_Zero:00000000 Straight_Calc_Zero
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:318    .text.Straight_Calc_Zero:00000024 $d
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:330    .text.Straight_SysTic_fb:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:337    .text.Straight_SysTic_fb:00000000 Straight_SysTic_fb
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:488    .text.Straight_SysTic_fb:000000f4 $d
                            *COM*:00000004 s_sum_l
                            *COM*:00000002 straight_pid_l
                            *COM*:00000004 s_sum_r
                            *COM*:00000002 straight_pid_r
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:508    .text.Yawrate_Calc_fb:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:515    .text.Yawrate_Calc_fb:00000000 Yawrate_Calc_fb
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:640    .text.Yawrate_Calc_fb:000000e0 $d
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:652    .text.Yawrate_Calc_Zero:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:659    .text.Yawrate_Calc_Zero:00000000 Yawrate_Calc_Zero
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:681    .text.Yawrate_Calc_Zero:00000010 $d
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:688    .text.Yawrate_SysTic_fb:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:695    .text.Yawrate_SysTic_fb:00000000 Yawrate_SysTic_fb
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:778    .text.Yawrate_SysTic_fb:00000088 $d
                            *COM*:00000002 yawrate_pid
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:791    .text.Control_pwm:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:798    .text.Control_pwm:00000000 Control_pwm
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:859    .text.Control_pwm:0000003c $d
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:867    .text.Output_Buzzer:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:874    .text.Output_Buzzer:00000000 Output_Buzzer
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:905    .text.Sensor_Check:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:912    .text.Sensor_Check:00000000 Sensor_Check
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:1008   .text.Sensor_Check:00000088 $d
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:1027   .bss.encoder_Kd:00000000 encoder_Kd
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:1034   .bss.encoder_Ki:00000000 encoder_Ki
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:1041   .bss.encoder_Kp:00000000 encoder_Kp
                            *COM*:00000004 y_sum
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:1023   .bss.encoder_Kd:00000000 $d
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:1030   .bss.encoder_Ki:00000000 $d
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:1037   .bss.encoder_Kp:00000000 $d
C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s:1044   .rodata.Straight_Calc_fb.str1.4:00000000 $d

UNDEFINED SYMBOLS
batt_Vcc
__aeabi_f2d
printf
calc
accel_T
constant_T
decrease_T
straight_cnt
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\ccvzb1uG.s 			page 25


enc
y_accel_T
y_constant_T
y_decrease_T
yawrate_cnt
gyro
Motor_pwm
flag
Buzzer_pwm
HAL_Delay
HAL_GPIO_WritePin
sensor
